import{_ as t,o as p,c as e,b as n,a as o,e as c,d as s,r as u}from"./app.75439bd2.js";const l={},i=c(`<h2 id="\u5728-react-\u4E2D\u501F\u52A9-proxy-\u5B9E\u73B0-vue3-\u7684-reactive" tabindex="-1"><a class="header-anchor" href="#\u5728-react-\u4E2D\u501F\u52A9-proxy-\u5B9E\u73B0-vue3-\u7684-reactive" aria-hidden="true">#</a> \u5728 react \u4E2D\u501F\u52A9 proxy \u5B9E\u73B0 Vue3 \u7684 reactive</h2><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> React<span class="token punctuation">,</span><span class="token punctuation">{</span> useState <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;react&#39;</span>
<span class="token comment">//proxy\u662F\u4EE3\u7406\u4E00\u4E2A\u5BF9\u8C61\uFF0C\u505A\u5BF9\u8C61\u7684\u5C5E\u6027\u52AB\u6301</span>
<span class="token keyword">function</span> <span class="token function">UseReactive</span><span class="token punctuation">(</span>initialState<span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span> state<span class="token punctuation">,</span>setState <span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span>initialState<span class="token punctuation">)</span>
  <span class="token comment">//\u501F\u52A9\u526F\u4F5C\u7528</span>
  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">//proxy handler</span>
    <span class="token keyword">const</span> handler <span class="token operator">=</span> <span class="token punctuation">{</span>
      <span class="token function">get</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span>property<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> target<span class="token punctuation">[</span>property<span class="token punctuation">]</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token function">set</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span>property<span class="token punctuation">,</span>value<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token operator">...</span>target<span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    initialState <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>initialState<span class="token punctuation">,</span>handler<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">const</span> state <span class="token operator">=</span> <span class="token function">UseReactive</span><span class="token punctuation">(</span><span class="token punctuation">{</span>count<span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
  state<span class="token punctuation">.</span>count <span class="token operator">+=</span> <span class="token number">1</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>\u62D3\u5C55:\u6A21\u62DF Vue3 \u4E2D\u7EC4\u4EF6\u7684\u72B6\u6001</li></ul><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>app<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{count}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>btn<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>click<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">count</span><span class="token operator">:</span><span class="token number">0</span> <span class="token punctuation">}</span>
<span class="token comment">//\u5C06\u8FD9\u4E2A\u72B6\u6001\u53D8\u6210\u54CD\u5E94\u5F0F,Vue2\u4E2D\u662F\u901A\u8FC7 Object.defineProperty\uFF0CVue3\u662FProxy</span>
<span class="token keyword">const</span> reactiveData <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span><span class="token punctuation">{</span>
  <span class="token function">set</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span>property<span class="token punctuation">,</span>value<span class="token punctuation">)</span><span class="token punctuation">{</span>
    target<span class="token punctuation">[</span>property<span class="token punctuation">]</span> <span class="token operator">=</span> value
    <span class="token function">updateView</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment">//updateView\u7B49\u4EF7\u4E8E Vue \u7684 new Vue({data:{count:0}}).$mount(&#39;#app&#39;)</span>
    <span class="token comment">//\u8FD9\u662F\u6BD4\u8F83\u7B28\u7684\u65B9\u6CD5\uFF0C\u56E0\u4E3A\u5728\u5C5E\u6027\u4E2D\u64CD\u4F5C\uFF0CVue\u6E90\u7801\u7528\u6536\u96C6\u4F9D\u8D56\u4EE3\u66FF\u4E86\u8FD9\u4E00\u6B65\u{1F6A9}</span>
    <span class="token keyword">return</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">get</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span>property<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> target<span class="token punctuation">[</span>property<span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">//\u66F4\u65B0\u89C6\u56FE</span>
<span class="token keyword">const</span> <span class="token function-variable function">updateView</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&quot;#app&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> reactiveData<span class="token punctuation">.</span>count
<span class="token punctuation">}</span>
<span class="token comment">//\u4F7F\u7528</span>
<span class="token keyword">const</span> btnDom <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&quot;#btn&quot;</span><span class="token punctuation">)</span>
btnDom<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;click&quot;</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
  reactiveData<span class="token punctuation">.</span>count <span class="token operator">++</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="usesyncexternastore-\u5C06-react-\u548C-redux-\u72B6\u6001\u8054\u7CFB" tabindex="-1"><a class="header-anchor" href="#usesyncexternastore-\u5C06-react-\u548C-redux-\u72B6\u6001\u8054\u7CFB" aria-hidden="true">#</a> useSyncExternaStore \u5C06 react \u548C redux \u72B6\u6001\u8054\u7CFB</h2>`,5),r={href:"https://zh-hans.react.dev/reference/react/useSyncExternalStore",target:"_blank",rel:"noopener noreferrer"},k=s("useSyncExternaStore"),d=s(" \u662F\u4E00\u4E2A\u8BA9\u4F60\u8BA2\u9605\u5916\u90E8 store \u7684 React Hook."),v=n("p",null,"\u9664\u4E86 proxy, useSyncExternaStore\u4E5F\u53EF\u4EE5\u5B9E\u73B0\u4E0A\u8FF0\u95EE\u9898\u3002",-1);function m(b,g){const a=u("ExternalLinkIcon");return p(),e("div",null,[i,n("p",null,[n("a",r,[k,o(a)]),d]),v])}var f=t(l,[["render",m],["__file","0101.html.vue"]]);export{f as default};
