---
title: React åŸºç¡€
date: 2023-10-10
tags:
  - react
categories:
  - å‰ç«¯å¼€å‘
---

## React æ˜¯ä»€ä¹ˆ

### ç®€ä»‹

React æ˜¯ä¸€ä¸ª**å£°æ˜å¼**ï¼Œé«˜æ•ˆä¸”çµæ´»çš„ç”¨äºæ„å»ºç”¨æˆ·ç•Œé¢çš„ Javascript åº“ã€‚ä½¿ç”¨ React å¯ä»¥å°†ä¸€äº›ç®€çŸ­ã€ç‹¬ç«‹çš„ä»£ç ç‰‡æ®µç»„åˆæˆå¤æ‚çš„ UI ç•Œé¢ï¼Œè¿™äº›ä»£ç åº“è¢«ç§°ä¸ºâ€œç»„ä»¶â€ã€‚

`UI = render(data) => å•å‘æ•°æ®æµ`

### MVC & MVVM & MVP

è¿™æ˜¯ 3 ç§å¸¸è§çš„è½¯ä»¶æ¶æ„è®¾è®¡æ¨¡å¼ï¼Œéƒ½æ˜¯é€šè¿‡åˆ†ç¦»å…³æ³¨ç‚¹çš„æ–¹å¼æ¥ç»„ç»‡ä»£ç ç»“æ„ï¼Œä¼˜åŒ–å¼€å‘æ•ˆç‡ã€‚

- MVCï¼šé€šè¿‡ `Model-View-Controller`ï¼ˆ`å‚¨å­˜é¡µé¢çš„ä¸šåŠ¡æ•°æ®åŠå¯¹åº”æ•°æ®çš„æ“ä½œ-æ˜¾ç¤ºé€»è¾‘-å‰ä¸¤è€…çš„çº½å¸¦ï¼Œäº‹ä»¶è§¦å‘å™¨`ï¼‰æ¥ç»„ç»‡ä»£ç ç»“æ„ã€‚
  ![](https://cetacea-1304984885.cos.ap-shanghai.myqcloud.com/pieces/mvc.png)

- MVPï¼šé€šè¿‡`Model-View-Presenter`,MVC åœ¨é€»è¾‘å¤æ‚ä¼šé€ æˆä»£ç æ··ä¹±ï¼ŒPresenter æ˜¯ Controller çš„æ”¹è‰¯ã€‚MVP æ¨¡å¼ä¸­ï¼ŒView å±‚çš„æ¥å£æš´éœ²ç»™äº† Presenterï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥åœ¨ Presenter ä¸­å°† Model å’Œ View çš„å˜åŒ–ç»‘å®šåœ¨ä¸€èµ·ï¼Œä»¥æ­¤æ¥å®ç° View å’Œ Model çš„**åŒæ­¥æ›´æ–°**ã€‚è¿™æ ·å°±å®ç°äº†å¯¹ View å’Œ Model çš„è§£è€¦ï¼ŒPresenter è¿˜åŒ…å«äº†å…¶ä»–çš„å“åº”é€»è¾‘ã€‚

  ![](https://cetacea-1304984885.cos.ap-shanghai.myqcloud.com/pieces/mvp.jpg)

- MVVMï¼š`Model-View-ViewModel`,MVC çš„æ”¹è¿›ç‰ˆ,å’Œ MVP çš„æ€æƒ³ç›¸åŒï¼Œä¸è¿‡å®ƒæ˜¯é€šè¿‡åŒå‘æ•°æ®ç»‘å®šï¼Œå°† View å’Œ Model çš„**åŒæ­¥æ›´æ–°è‡ªåŠ¨åŒ–äº†**ã€‚å½“ Model å‘ç”Ÿå˜åŒ–æ—¶ï¼ŒViewModel å°±ä¼šè‡ªåŠ¨æ›´æ–°ï¼›ViewModel æ›´æ–°äº†ï¼ŒView ä¹Ÿä¼šæ›´æ–°ã€‚è¿™æ ·å°† `presenter` çš„å·¥ä½œè‡ªåŠ¨åŒ–äº†ã€‚åœ¨ Vue ä¸­ï¼Œæ˜¯é€šè¿‡æ•°æ®åŠ«æŒå’Œå‘å¸ƒè®¢é˜…è€…æ¨¡å¼æ¥å®ç°è¿™ä¸ªåŠŸèƒ½çš„ã€‚
  ![](https://cetacea-1304984885.cos.ap-shanghai.myqcloud.com/pieces/mvvm.png)

## JSX æ¨¡æ¿è¯­æ³•

:::info

JSX æ˜¯ Javascript çš„è¯­æ³•æ‰©å±•ï¼Œè¿ç”¨äº React ä¸­ï¼Œæ ¼å¼åƒæ¨¡æ¿è¯­è¨€ï¼Œäº‹å®ä¸Šåœ¨ Javascript å†…éƒ¨å®ç°ã€‚å…ƒç´ æ˜¯æ„æˆ React åº”ç”¨çš„æœ€å°å•ä½ï¼ŒJSX æ˜¯å£°æ˜ React ä¸­çš„å…ƒç´ ã€‚

JSX å¯ä½¿ç”¨å¼•å·æ¥å®šä¹‰ä»¥å­—ç¬¦ä¸²ä¸ºå€¼çš„å±æ€§ï¼š`const element = <div tabIndex="0"></div>`

å¯ä½¿ç”¨å¤§æ‹¬å·æ¥å®šä¹‰ä»¥JavaScriptè¡¨è¾¾å¼ä¸ºå€¼çš„å±æ€§ï¼š`const element = <img src={user.avatarUrl} />`

- å› ä¸º JSX è¯­æ³•ä¸Šæ›´æ¥è¿‘ JS è€Œä¸æ˜¯ HTMLï¼Œæ‰€ä»¥ä½¿ç”¨ camelCaseï¼ˆå°é©¼å³°å‘½åï¼‰æ¥å®šä¹‰å±æ€§çš„åç§°ï¼›
**JSX é‡Œçš„ class å˜æˆäº† classNameï¼Œè€Œ tabindex åˆ™å˜ä¸º tabIndex**ã€‚
- æ²¡æœ‰å­èŠ‚ç‚¹çš„Reactå…ƒç´ å¯ä»¥ç”¨ /> ç»“æŸï¼›
- **ä¸ºä»€ä¹ˆjsxé‡Œè¦å†™html**?JSX æ˜¯ JavaScript XML çš„ç®€å†™ï¼Œè¡¨ç¤ºåœ¨ JavaScript ä»£ç ä¸­å†™XMLï¼ˆHTMLï¼‰æ ¼å¼çš„ä»£ç ã€‚å£°æ˜å¼è¯­æ³•æ›´åŠ ç›´è§‚ï¼Œä¸HTMLç»“æ„ç›¸åŒï¼Œé™ä½äº†å­¦ä¹ æˆæœ¬ã€æå‡å¼€å‘æ•ˆç‡ã€‚JSX æ˜¯ React çš„æ ¸å¿ƒå†…å®¹ã€‚

:::

### JSX æ”¯æŒçš„è¡¨è¾¾å¼

JSX æ”¯æŒè¡¨è¾¾å¼ã€å˜é‡ã€æ–¹æ³•åã€‚
```jsx
// å˜é‡
const name = 'Josh Perez';
const element = <h1>Hello, {name}</h1>;
function formatName(user) {
  return user.firstName + ' ' + user.lastName;
}

// æ–¹æ³•
const user = {
  firstName: 'Harper',
  lastName: 'Perez'
};

const element = (
  <h1>
    Hello, {formatName(user)}!
  </h1>
);

function getGreeting(user) {
  if (user) {
    return <h1>Hello, {formatName(user)}!</h1>;
  }
  return <h1>Hello, Stranger.</h1>;
}
```

### JSX æŒ‡å®šå±æ€§

â“è¿™ä¸€å—ä¸å¤ªæ‡‚

```jsx
const element = <img src={user.avatarUrl}></img>;

æ³¨æ„ï¼šJSXæ”¯æŒé˜²æ³¨å…¥(é˜²æ­¢XSSæ”»å‡»)
const title = response.potentiallyMaliciousInput;  // æ­¤æ—¶åªæ˜¯å­—ç¬¦ä¸²
// ç›´æ¥ä½¿ç”¨æ˜¯å®‰å…¨çš„ï¼š const element = <h1>{title}</h1>;

React å¦‚ä½•é¢„é˜²XSS

// åå°„å‹ XSS

https://xxx.com/search?query=userInput

// æœåŠ¡å™¨åœ¨å¯¹æ­¤ URL çš„å“åº”ä¸­å›æ˜¾æä¾›çš„æœç´¢è¯ï¼šquery=123
<p>æ‚¨æœç´¢çš„æ˜¯: 123</p>

// https://xxx.com/search?query=<img src="empty.png" onerror ="alert('xss')">
<p>æ‚¨æœç´¢çš„æ˜¯: <img src="empty.png" onerror ="alert('xss')"></p>
// å¦‚æœæœ‰ç”¨æˆ·è¯·æ±‚æ”»å‡»è€…çš„ URL ï¼Œåˆ™æ”»å‡»è€…æä¾›çš„è„šæœ¬å°†åœ¨ç”¨æˆ·çš„æµè§ˆå™¨ä¸­æ‰§è¡Œã€‚

  
// å­˜å‚¨å‹ XSSï¼Œå­˜å‚¨åˆ°ç›®æ ‡æ•°æ®åº“
// è¯„è®ºè¾“å…¥ï¼Œæ‰€æœ‰è®¿é—®ç”¨æˆ·éƒ½èƒ½çœ‹åˆ°äº†
<textarea>
  <img src="empty.png" onerror ="alert('xss')">
</textarea>
  
// éƒ¨åˆ†æºç 
for (index = match.index; index < str.length; index++) {
  switch (str.charCodeAt(index)) {
    case 34: // "
      escape = '&quot;';
      break;
    case 38: // &
      escape = '&amp;';
      break;
    case 39: // '
      escape = '&#x27;';
      break;
    case 60: // <
      escape = '&lt;';
      break;
    case 62: // >
      escape = '&gt;';
      break;
    default:
      continue;
  }
}

// ä¸€æ®µæ¶æ„ä»£ç 
<img src="empty.png" onerror ="alert('xss')"> 
// React åœ¨æ¸²æŸ“åˆ°æµè§ˆå™¨å‰è¿›è¡Œçš„è½¬ä¹‰ï¼Œå¯ä»¥çœ‹åˆ°å¯¹æµè§ˆå™¨æœ‰ç‰¹æ®Šå«ä¹‰çš„å­—ç¬¦éƒ½è¢«è½¬ä¹‰äº†
// æ¶æ„ä»£ç åœ¨æ¸²æŸ“åˆ° HTML å‰éƒ½è¢«è½¬æˆäº†å­—ç¬¦ä¸²
&lt;img src=&quot;empty.png&quot; onerror =&quot;alert(&#x27;xss&#x27;)&quot;&gt; 
  
// JSX
const element = (
  <h1 className="greeting">
      Hello, world!
  </h1>
);
  
// é€šè¿‡ babel ç¼–è¯‘åçš„ä»£ç 
const element = React.createElement(
  'h1',
  {className: 'greeting'},
  'Hello, world!'
);
  
// React.createElement() æ–¹æ³•è¿”å›çš„ ReactElement
const element = {
  $$typeof: Symbol('react.element'),
  type: 'h1',
  key: null,
  props: {
    children: 'Hello, world!',
        className: 'greeting'   
  }
  ...
}
 
// å¦‚ä½•æ¨¡æ‹Ÿä¸€ä¸ªChildrenä¼šå¦‚ä½•ï¼Ÿ
const storedData = {
    "ref":null,
    "type":"body",
    "props":{
        "dangerouslySetInnerHTML":{
            "__html":"<img src=\"empty.png\" onerror =\"alert('xss')\"/>"
        }
    }
};
// è½¬æˆ JSON
const parsedData = JSON.parse(storedData);
// å°†æ•°æ®æ¸²æŸ“åˆ°é¡µé¢
render () {
    return <span> {parsedData} </span>; 
}
  
// $$typeof æ˜¯ç”¨æ¥æ ‡è®°ä¸€ä¸ªReactElementçš„ï¼ŒJSONåŒ–åSymbolä¼šä¸¢å¤±ï¼ŒReactä¼šæŠ¥é”™
```

### JSX è¡¨ç¤ºå¯¹è±¡
```jsx
const element = (
  <h1 className="greeting"> //åŒºåˆ«äºhtmlè¯­æ³•ä¸­çš„class,jsxä¸­æ˜¯className
    Hello, world!
  </h1>
);
// ç­‰åŒäºReact.createElement
const element = React.createElement(
  'h1',
  {className: 'greeting'},
  'Hello, world!'
);
const element = {
  type: 'h1',
  props: {
    className: 'greeting',
    children: 'Hello, world!'
  }
}
```

### å°† JSX æ¸²æŸ“æˆ DOM
```jsx
// ä½¿ç”¨ReactDOM.render
const element = <h1>Hello, world</h1>;
ReactDOM.render(element, document.getElementById('root'));
// renderåªèƒ½ä»£è¡¨å½“å‰æ—¶åˆ»çš„çŠ¶æ€
// æ›´æ–°å…ƒç´  åªèƒ½å†æ¬¡ ReactDOM.render
function tick() {
  const element = (
    <div>
      <h1>Hello, world!</h1>
      <h2>It is {new Date().toLocaleTimeString()}.</h2>
    </div>
  );
  ReactDOM.render(element, document.getElementById('root')); 
}
setInterval(tick, 1000); // ä¸å»ºè®®å¤šæ¬¡render
```

### JSX è½¬æˆ JS

JSX å¯ä»¥å½“ä½œè¯­æ³•ç³–ï¼Œåœ¨ [babel å®˜ç½‘ä¸­å°è¯•](https://babeljs.io/repl#?browsers=defaults%2C%20not%20ie%2011%2C%20not%20ie_mob%2011&build=&builtIns=false&corejs=3.21&spec=false&loose=false&code_lz=Q&debug=false&forceAllTransforms=false&modules=false&shippedProposals=false&circleciRepo=&evaluate=false&fileSize=false&timeTravel=false&sourceType=module&lineWrap=true&presets=env%2Creact%2Cstage-2&prettier=false&targets=&version=7.24.5&externalPlugins=&assumptions=%7B%7D)
```js

// å®‰è£…babel åŠreact çš„ä¾èµ–
npm install core-js @babel/core @babel/preset-env @babel/
preset-react @babel/register babel-loader @babel/
plugin-transform-runtime --save-dev

.babelrc
{
    "presets" : [ 
        "@babel/preset-env" ,
        "@babel/preset-es2015",
        "@babel/preset-react"
    ],
    "plugins" : [
        "@babel/plugin-transform-runtime"
    ]
}
```

## props åŠ state

### ç»„ä»¶

ç»„ä»¶ï¼Œç±»ä¼¼äº Javascript ä¸­çš„å‡½æ•°ï¼Œæ¥å—ä»»æ„å…¥å‚ï¼ˆpropsï¼‰ï¼Œå¹¶è¿”å›ç”¨äºæè¿°é¡µé¢å†…å®¹çš„ React å…ƒç´ ã€‚æœ‰å‡½æ•°å¼ç»„ä»¶å’Œ Class ç±»ç»„ä»¶ã€‚
```jsx
function Welcome(props) {
  return <h1>Hello, {props.name}</h1>;
}
class Welcome extends React.Component {
  render() {
    return <h1>Hello, {this.props.name}</h1>;
  }
}
```
>ğŸ¦tips:æ­¤åˆ»æˆ‘æ‰æ˜ç™½ä¹‹å‰æœ‰ä¸ªè€å¸ˆè¯´ React æ›´æ¥è¿‘äºå‡½æ•°å¼ç¼–ç¨‹çš„æ€æƒ³ã€‚ä¸” React çš„æ ¸å¿ƒæ˜¯ JSX = Javascript XMLï¼ŒJSX åœ¨ Javascript å†…éƒ¨å®ç°ã€‚

- æ¸²æŸ“ç»„ä»¶
  ```jsx
  function Welcome(props) {
  return <h1>Hello, {props.name}</h1>;
  }

  const element = <Welcome name="Sara" />;
  ReactDOM.render(
    element,
    document.getElementById('root')
  );

  // è‡ªå®šä¹‰ç»„ä»¶ä½¿ç”¨å¤§å†™å­—æ¯å¼€å¤´
  import React from 'react';

  // æ­£ç¡®ï¼ç»„ä»¶éœ€è¦ä»¥å¤§å†™å­—æ¯å¼€å¤´ï¼š
  function Hello(props) {
    // æ­£ç¡®ï¼ è¿™ç§ <div> çš„ä½¿ç”¨æ˜¯åˆæ³•çš„ï¼Œå› ä¸º div æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„ HTML æ ‡ç­¾ï¼š
    return <div>Hello {props.toWhat}</div>;
  }

  function HelloWorld() {
    // æ­£ç¡®ï¼React çŸ¥é“ <Hello /> æ˜¯ä¸€ä¸ªç»„ä»¶ï¼Œå› ä¸ºå®ƒæ˜¯å¤§å†™å­—æ¯å¼€å¤´çš„ï¼š
    return <Hello toWhat="World" />;
  }
  ```

- ç»„ä»¶çš„æ‹†åˆ†å’Œç»„åˆ

â“è¿™ä¸€å—ä¸å¤ªæ‡‚
  ```jsx
  // é¡µé¢å†…å¤šæ¬¡å¼•ç”¨
  <div>
    <Welcome name="Sara" />
    <Welcome name="Cahal" />
    <Welcome name="Edite" />
  </div>

  function Comment(props) {
    return (
      <div className="Comment">
        <div className="UserInfo">
          <img className="Avatar"
            src={props.author.avatarUrl}
            alt={props.author.name}
          />
          <div className="UserInfo-name">
            {props.author.name}
          </div>
        </div>
        <div className="Comment-text">
          {props.text}
        </div>
        <div className="Comment-date">
          {formatDate(props.date)}
        </div>
      </div>
    );
  }

  // æ‹†åˆ†åä¸º
  function Comment(props) {
    return (
      <div className="Comment">
        <UserInfo user={props.author} />
        <div className="Comment-text">
          {props.text}
        </div>
        <div className="Comment-date">
          {formatDate(props.date)}
        </div>
      </div>
    );
  }
  ```

- å—æ§ç»„ä»¶ä¸éå—æ§ç»„ä»¶ï¼š

  1ï¸âƒ£å—æ§ç»„ä»¶ï¼šç»„ä»¶çŠ¶æ€åªèƒ½ç”±ç”¨æˆ·æ§åˆ¶è€Œéä»£ç ã€‚
  >åœ¨HTMLçš„è¡¨å•å…ƒç´ ä¸­ï¼Œå®ƒä»¬é€šå¸¸è‡ªå·±ç»´æŠ¤ä¸€å¥—stateï¼Œå¹¶éšç€ç”¨æˆ·çš„è¾“å…¥è‡ªå·±è¿›è¡ŒUIä¸Šçš„æ›´æ–°ï¼Œè¿™ç§è¡Œä¸ºæ˜¯ä¸è¢«æˆ‘ä»¬ç¨‹åºæ‰€ç®¡æ§çš„ã€‚è€Œå¦‚æœå°†Reacté‡Œçš„stateå±æ€§å’Œè¡¨å•å…ƒç´ çš„å€¼å»ºç«‹ä¾èµ–å…³ç³»ï¼Œå†é€šè¿‡onChangeäº‹ä»¶ä¸setState()ç»“åˆæ›´æ–°stateå±æ€§ï¼Œå°±èƒ½è¾¾åˆ°æ§åˆ¶ç”¨æˆ·è¾“å…¥è¿‡ç¨‹ä¸­è¡¨å•å‘ç”Ÿçš„æ“ä½œã€‚è¢«Reactä»¥è¿™ç§æ–¹å¼æ§åˆ¶å–å€¼çš„è¡¨å•è¾“å…¥å…ƒç´ å°±å«åšå—æ§ç»„ä»¶ã€‚
  ```jsx
  // inputè‡ªèº«ç»´æŠ¤çš„çŠ¶æ€ï¼Œå¤–ç•Œæ— æ³•è·å–æ•°æ®
  class TestComponent extends React.Component {
    render () {
      return <input name="username" />
    }
  }

  // å¯ä»¥è®¾ç½®åˆå§‹å€¼
  class TestComponent extends React.Component {
    constructor (props) {
      super(props);
      this.state = { username: 'test' };
    }
    render () {
      return <input name="username" value={this.state.username} />
    }
  }

  // å¯ä»¥è¯»å–å¹¶è®¾ç½®åˆå§‹å€¼
  class TestComponent extends React.Component {
    constructor (props) {
      super(props);
      this.state = {
        username: "test"
      }
    }
    onChange (e) {
      console.log(e.target.value);
      this.setState({
        username: e.target.value
      })
    }
    render () {
      return <input name="username" value={this.state.username} onChange={(e) => this.onChange(e)} />
    }
  ```

  2ï¸âƒ£éå—æ§ç»„ä»¶:ç»„ä»¶çŠ¶æ€åªèƒ½ç”±ä»£ç æ§åˆ¶è€Œéç”¨æˆ·ã€‚
  ```jsx
  // å¦‚æœä¸æƒ³å…³å¿ƒè¡¨å•å…ƒç´ çš„å€¼æ˜¯å¦‚ä½•å˜åŒ–çš„ï¼Œåªæƒ³å–å€¼ï¼Œå¯ä»¥ä½¿ç”¨ref
  import React, { Component } from 'react';

  export class UnControll extends Component {
    constructor (props) {
      super(props);
      this.inputRef = React.createRef();
    }
    handleSubmit = (e) => {
      console.log('æˆ‘ä»¬å¯ä»¥è·å¾—inputå†…çš„å€¼ä¸º', this.inputRef.current.value);
      e.preventDefault();
    }
    render () {
      return (
        <form onSubmit={e => this.handleSubmit(e)}>
          <input defaultValue="lindaidai" ref={this.inputRef} />
          <input type="submit" value="æäº¤" />
        </form>
      )
    }
  }
  ```

### props

æ‰€æœ‰çš„ React ç»„ä»¶å¿…é¡»åƒçº¯å‡½æ•°ä¸€æ ·ä¿æŠ¤ä»–ä»¬çš„ props ä¸è¢«æ›´æ”¹ã€‚
```jsx
// é”™è¯¯ï¼Œè¦åƒçº¯å‡½æ•°ä¸€æ ·å¹‚ç­‰
function withdraw(account, amount) {
  account.total -= amount;
}
```

### state

éœ€è¡¥å……

## ç”Ÿå‘½å‘¨æœŸ
![](https://cetacea-1304984885.cos.ap-shanghai.myqcloud.com/pieces/react_lifecycle.png)

## äº‹ä»¶å¤„ç†

### è¯­æ³•æ ¼å¼

1. åœ¨JSXå…ƒç´ ä¸Šæ·»åŠ äº‹ä»¶,é€šè¿‡on*EventTypeè¿™ç§å†…è”æ–¹å¼æ·»åŠ ,å‘½åé‡‡ç”¨å°é©¼å³°å¼(camelCase)çš„å½¢å¼,è€Œä¸æ˜¯çº¯å°å†™(åŸç”ŸHTMLä¸­å¯¹DOMå…ƒç´ ç»‘å®šäº‹ä»¶,äº‹ä»¶ç±»å‹æ˜¯å°å†™çš„)ï¼›
2. æ— éœ€è°ƒç”¨addEventListenerè¿›è¡Œäº‹ä»¶ç›‘å¬ï¼Œä¹Ÿæ— éœ€è€ƒè™‘å…¼å®¹æ€§ï¼ŒReactå·²ç»å°è£…å¥½äº†ä¸€äº›çš„äº‹ä»¶ç±»å‹å±æ€§ï¼›
3. ä½¿ç”¨ JSX è¯­æ³•æ—¶ä½ éœ€è¦ä¼ å…¥ä¸€ä¸ªå‡½æ•°ä½œä¸ºäº‹ä»¶å¤„ç†å‡½æ•°ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼›
4. ä¸èƒ½é€šè¿‡è¿”å› false çš„æ–¹å¼é˜»æ­¢é»˜è®¤è¡Œä¸ºã€‚ä½ å¿…é¡»æ˜¾å¼çš„ä½¿ç”¨ preventDefaultï¼›

### æ¥æ”¶å‚æ•°

1. äº‹ä»¶å¯¹è±¡ e ä¼šè¢«ä½œä¸ºç¬¬äºŒä¸ªå‚æ•°ä¼ é€’ï¼›
2. é€šè¿‡ç®­å¤´å‡½æ•°çš„æ–¹å¼ï¼Œäº‹ä»¶å¯¹è±¡å¿…é¡»æ˜¾å¼çš„è¿›è¡Œä¼ é€’ï¼›
3. é€šè¿‡ Function.prototype.bind çš„æ–¹å¼ï¼Œäº‹ä»¶å¯¹è±¡ä»¥åŠæ›´å¤šçš„å‚æ•°å°†ä¼šè¢«éšå¼çš„è¿›è¡Œä¼ é€’ï¼›
```jsx
<button onClick={(e) => this.deleteRow(id, e)}>Delete Row</button>
<button onClick={this.deleteRow.bind(this, id)}>Delete Row</button>
```

## æ¡ä»¶æ¸²æŸ“

### if else
```jsx
class LoginControl extends React.Component {
  constructor(props) {
    super(props);
    this.handleLoginClick = this.handleLoginClick.bind(this);
    this.handleLogoutClick = this.handleLogoutClick.bind(this);
    this.state = {isLoggedIn: false};
  }
  handleLoginClick() {
    this.setState({isLoggedIn: true});
  }
  handleLogoutClick() {
    this.setState({isLoggedIn: false});
  }
  render() {
    const isLoggedIn = this.state.isLoggedIn;
    let button;
    if (isLoggedIn) {
      button = <LogoutButton onClick={this.handleLogoutClick} />;
    } else {
      button = <LoginButton onClick={this.handleLoginClick} />;
    }
    return (
      <div>
        <Greeting isLoggedIn={isLoggedIn} />
        {button}
      </div>
    );
  }
}
ReactDOM.render(
  <LoginControl />,
  document.getElementById('root')
);
```

### && ä¸è¿ç®—ç¬¦
```jsx
function Mailbox(props) {
  const unreadMessages = props.unreadMessages;
  return (
    <div>
      <h1>Hello!</h1>
      {unreadMessages.length > 0 &&
        <h2>
          You have {unreadMessages.length} unread messages.
        </h2>
      }
    </div>
  );
}
const messages = ['React', 'Re: React', 'Re:Re: React'];
ReactDOM.render(
  <Mailbox unreadMessages={messages} />,
  document.getElementById('root')
);
// è¿”å›falseçš„è¡¨è¾¾å¼ï¼Œä¼šè·³è¿‡å…ƒç´ ï¼Œä½†ä¼šè¿”å›è¯¥è¡¨è¾¾å¼
render() {
  const count = 0;
  return (
    <div>
      { count && <h1>Messages: {count}</h1>}
    </div>
  );
}
```

### ä¸‰å…ƒè¿ç®—ç¬¦
```jsx
render() {
  const isLoggedIn = this.state.isLoggedIn;
  return (
    <div>
      {isLoggedIn
        ? <LogoutButton onClick={this.handleLogoutClick} />
        : <LoginButton onClick={this.handleLoginClick} />
      }
    </div>
  );
}
```

### å¦‚ä½•é˜»æ­¢ç»„ä»¶æ¸²æŸ“
```jsx
function WarningBanner(props) {
  if (!props.warn) {
    return null;
  }

  return (
    <div className="warning">
      Warning!
    </div>
  );
}

class Page extends React.Component {
  constructor(props) {
    super(props);
    this.state = {showWarning: true};
    this.handleToggleClick = this.handleToggleClick.bind(this);
  }

  handleToggleClick() {
    this.setState(state => ({
      showWarning: !state.showWarning
    }));
  }

  render() {
    return (
      <div>
        <WarningBanner warn={this.state.showWarning} />
        <button onClick={this.handleToggleClick}>
          {this.state.showWarning ? 'Hide' : 'Show'}
        </button>
      </div>
    );
  }
}

ReactDOM.render(
  <Page />,
  document.getElementById('root')
);
```

## åˆ—è¡¨
```jsx
function NumberList(props) {
  const numbers = props.numbers;
  const listItems = numbers.map((number) =>
    <li key={number.toString()}>
      {number}
    </li>
  );
  
  return (
    <ul>{listItems}</ul>
  );
}

const numbers = [1, 2, 3, 4, 5];
ReactDOM.render(
  <NumberList numbers={numbers} />,
  document.getElementById('root')
);
// è‹¥æ²¡æœ‰keyï¼Œä¼šwarning a key should be provided for list items
// keyå¯ä»¥å¸®åŠ©react diffï¼Œæœ€å¥½ä¸ç”¨indexä½œä¸ºkeyï¼Œä¼šå¯¼è‡´æ€§èƒ½å˜å·®ï¼›
// å¦‚æœä¸æŒ‡å®šæ˜¾å¼çš„ key å€¼ï¼Œé»˜è®¤ä½¿ç”¨ç´¢å¼•ç”¨ä½œä¸ºåˆ—è¡¨é¡¹ç›®çš„ key å€¼ï¼›
```

## create-react-app

:::info

[å®˜ç½‘](https://create-react-app.dev/)ï¼Œcreate-react-appæ˜¯ä¸€ä¸ªå®˜æ–¹æ”¯æŒçš„åˆ›å»ºReactå•é¡µåº”ç”¨ç¨‹åºçš„è„šæ‰‹æ¶ã€‚å®ƒæä¾›äº†ä¸€ä¸ªé›¶é…ç½®çš„ç°ä»£åŒ–é…ç½®è®¾ç½®ã€‚

:::

## immutable & immer

### immutable

[å®˜ç½‘](https://immutable-js.com/)

Facebook å·¥ç¨‹å¸ˆ Lee Byron èŠ±è´¹ 3 å¹´æ—¶é—´æ‰“é€ ï¼Œä¸ React åŒæœŸå‡ºç°ï¼Œä½†æ²¡æœ‰è¢«é»˜è®¤æ”¾åˆ° React å·¥å…·é›†é‡Œï¼ˆReact æä¾›äº†ç®€åŒ–çš„ Helperï¼‰ã€‚å®ƒå†…éƒ¨å®ç°äº†ä¸€å¥—å®Œæ•´çš„ Persistent Data Structureï¼Œè¿˜æœ‰å¾ˆå¤šæ˜“ç”¨çš„æ•°æ®ç±»å‹ã€‚åƒ Collectionã€Listã€Mapã€Setã€Recordã€Seqã€‚æœ‰éå¸¸å…¨é¢çš„mapã€filterã€groupByã€reduce``findå‡½æ•°å¼æ“ä½œæ–¹æ³•ã€‚åŒæ—¶ API ä¹Ÿå°½é‡ä¸ Object æˆ– Array ç±»ä¼¼ã€‚

### immer

[å®˜ç½‘](https://immerjs.github.io/immer/zh-CN/)

- currentStateï¼šè¢«æ“ä½œå¯¹è±¡çš„æœ€åˆçŠ¶æ€
- draftStateï¼šæ ¹æ® currentState ç”Ÿæˆçš„è‰ç¨¿çŠ¶æ€ï¼Œå®ƒæ˜¯ currentState çš„ä»£ç†ï¼Œå¯¹ draftState æ‰€åšçš„ä»»ä½•ä¿®æ”¹éƒ½å°†è¢«è®°å½•å¹¶ç”¨äºç”Ÿæˆ nextState ã€‚åœ¨æ­¤è¿‡ç¨‹ä¸­ï¼ŒcurrentState å°†ä¸å—å½±å“
- nextStateï¼šæ ¹æ® draftState ç”Ÿæˆçš„æœ€ç»ˆçŠ¶æ€
- produceï¼šç”¨æ¥ç”Ÿæˆ nextState æˆ– producer çš„å‡½æ•°
- producerï¼šé€šè¿‡ produce ç”Ÿæˆï¼Œç”¨æ¥ç”Ÿäº§ nextState ï¼Œæ¯æ¬¡æ‰§è¡Œç›¸åŒçš„æ“ä½œ
- recipeï¼šç”¨æ¥æ“ä½œ draftState çš„å‡½æ•°

