---
title: å¾®ä¿¡å°ç¨‹åº
date: 2023-08-10
tags:
  - å°ç¨‹åºå¼€å‘
categories:
  - å‰ç«¯å¼€å‘
---

## ä¸€ã€åŸºç¡€

[å®˜æ–¹æ–‡æ¡£](https://developers.weixin.qq.com/miniprogram/dev/framework/) ğŸ‘¾
[github](https://github.com/wechat-miniprogram/miniprogram-demo)

### å°ç¨‹åºæ¡†æ¶

**1. é€»è¾‘å±‚**

- å®˜æ–¹æ–‡æ¡£ï¼š[App Service](https://developers.weixin.qq.com/miniprogram/dev/framework/app-service/)ï¼›

- ä½¿ç”¨Javascriptå¼•æ“ä¸ºå°ç¨‹åºæä¾›å¼€å‘è€…Javascriptä»£ç çš„è¿è¡Œç¯å¢ƒä»¥åŠå¾®ä¿¡å°ç¨‹åºçš„ç‰¹æœ‰åŠŸèƒ½ï¼›

- å¼€å‘è€…çš„æ‰€æœ‰ä»£ç æœ€ç»ˆä¼šæ‰“åŒ…æˆä¸€ä»½Javascriptæ–‡ä»¶ï¼Œå¹¶åœ¨å°ç¨‹åºå¯åŠ¨æ—¶è¿è¡Œï¼Œç›´åˆ°å°ç¨‹åºé”€æ¯ã€‚è¿™ä¸€è¡Œä¸ºç±»ä¼¼[ServiceWorker](https://developer.mozilla.org/en-US/docs/Web/API/Service_Worker_API),æ‰€ä»¥é€»è¾‘å±‚ä¹Ÿç§°ä¸º`App Service`;

- å¢åŠ `App`å’Œ`Page`,è¿›è¡Œ[ç¨‹åºæ³¨å†Œ](https://developers.weixin.qq.com/miniprogram/dev/framework/app-service/app.html)å’Œ[é¡µé¢æ³¨å†Œ](https://developers.weixin.qq.com/miniprogram/dev/framework/app-service/page.html);

- å¢åŠ `getApp`å’Œ`getCurrentPage`,åˆ†åˆ«è·å–Appå®ä¾‹å’Œå½“å‰é¡µé¢æ ˆï¼›

- æä¾›ä¸°å¯Œçš„[API](https://developers.weixin.qq.com/miniprogram/dev/framework/app-service/api.html),å¦‚è·å–å¾®ä¿¡ç”¨æˆ·æ•°æ®ï¼Œæ‰«ä¸€æ‰«ï¼Œæ”¯ä»˜ç­‰å¾®ä¿¡ç‰¹æœ‰èƒ½åŠ›ï¼›

- æä¾›[æ¨¡å—åŒ–](https://developers.weixin.qq.com/miniprogram/dev/framework/app-service/module.html#%E6%A8%A1%E5%9D%97%E5%8C%96)èƒ½åŠ›ï¼Œæ¯ä¸ªé¡µé¢éƒ½æœ‰ç‹¬ç«‹çš„[æ–‡ä»¶ä½œç”¨åŸŸ](https://developers.weixin.qq.com/miniprogram/dev/framework/app-service/module.html#%E6%96%87%E4%BB%B6%E4%BD%9C%E7%94%A8%E5%9F%9F)ï¼›

- å°ç¨‹åºé€»è¾‘å±‚ä¸æ˜¯åº”ç”¨åœ¨æµè§ˆå™¨ä¸­ï¼Œå› æ­¤webèƒ½åŠ›æ— æ³•åº”ç”¨ï¼Œå¦‚windowã€document...

**2. è§†å›¾å±‚**

[æ–‡æ¡£](https://developers.weixin.qq.com/miniprogram/dev/framework/view/)ï¼Œè§†å›¾å±‚ç”± WXML å’Œ WXSS ç¼–å†™ï¼Œç”±ç»„ä»¶è¿›è¡Œå±•ç¤ºã€‚å°†é€»è¾‘å±‚çš„æ•°æ®åæ˜ æˆè§†å›¾ï¼Œå°†è§†å›¾å±‚çš„äº‹ä»¶å‘é€ç»™é€»è¾‘å±‚ã€‚

### å°ç¨‹åºè¿è¡Œæ—¶

- å°ç¨‹åºç”Ÿå‘½å‘¨æœŸï¼šçƒ­å¯åŠ¨ => åå°åˆ‡å‰å°

![](https://res.wx.qq.com/wxdoc/dist/assets/img/life-cycle.5558d9eb.svg)

- æ›´æ–°æœºåˆ¶ï¼š
    1. å¯åŠ¨æ—¶åŒæ­¥æ›´æ–°ï¼šå®šæœŸæ£€æŸ¥å°ç¨‹åºç‰ˆæœ¬ï¼›é•¿æ—¶é—´æœªä½¿ç”¨å°ç¨‹åº
    2. å¯åŠ¨æ—¶å¼‚æ­¥æ›´æ–°ï¼šæ‰“å¼€å‘ç°æœ‰æ–°ç‰ˆæœ¬ï¼Œå¼‚æ­¥ä¸‹è½½ï¼Œä¸‹æ¬¡å†·å¯åŠ¨åŠ è½½æ–°ç‰ˆæœ¬
    3. å¼€å‘è€…æ‰‹åŠ¨æ›´æ–°ï¼š[wx.getUpdateManger()](https://developers.weixin.qq.com/miniprogram/dev/api/base/update/wx.getUpdateManager.html)

### ä»£ç æ³¨å…¥

- æŒ‰éœ€æ³¨å…¥ï¼šå°ç¨‹åºä»…æ³¨å…¥å½“å‰é¡µé¢éœ€è¦çš„ç»„ä»¶å’Œä»£ç ï¼Œæ²¡ç”¨åˆ°çš„ä¸ä¼šè¢«åŠ è½½å’Œåˆå§‹åŒ–ï¼›
```json
{"lazyCodeLoading": "requiredComponents"}
```
- ç”¨æ—¶æ³¨å…¥ï¼šåœ¨å¼€å¯ã€ŒæŒ‰éœ€æ³¨å…¥ã€ç‰¹æ€§çš„å‰æä¸‹ï¼Œã€Œç”¨æ—¶æ³¨å…¥ã€å¯ä»¥æŒ‡å®šä¸€éƒ¨åˆ†è‡ªå®šä¹‰ç»„ä»¶ä¸åœ¨å°ç¨‹åºå¯åŠ¨æ—¶æ³¨å…¥ï¼Œè€Œæ˜¯åœ¨çœŸæ­£æ¸²æŸ“çš„æ—¶å€™æ‰è¿›è¡Œæ³¨å…¥ã€‚

### åˆ†åŒ…åŠ è½½

- åŸåˆ™ï¼š
  1. å£°æ˜ subpackages åï¼Œå°†æŒ‰ subpackages é…ç½®è·¯å¾„è¿›è¡Œæ‰“åŒ…ï¼Œsubpackages é…ç½®è·¯å¾„å¤–çš„ç›®å½•å°†è¢«æ‰“åŒ…åˆ°ä¸»åŒ…ä¸­
  2. ä¸»åŒ…ä¹Ÿå¯ä»¥æœ‰è‡ªå·±çš„ pagesï¼Œå³æœ€å¤–å±‚çš„ pages å­—æ®µã€‚
  3. subpackage çš„æ ¹ç›®å½•ä¸èƒ½æ˜¯å¦å¤–ä¸€ä¸ª subpackage å†…çš„å­ç›®å½•
  4. tabBar é¡µé¢å¿…é¡»åœ¨ä¸»åŒ…å†…

- ç‹¬ç«‹åˆ†åŒ…ï¼š
  1. å¼€å‘è€…å¯æŒ‰éœ€å°†æŸäº›åŠŸèƒ½ç‹¬ç«‹çš„é¡µé¢é…ç½®åˆ°ç‹¬ç«‹åˆ†åŒ…ä¸­ã€‚å½“å°ç¨‹åºä»æ™®é€šçš„åˆ†åŒ…é¡µé¢å¯åŠ¨ï¼Œéœ€å…ˆä¸‹è½½ä¸»åŒ…
  2. ç‹¬ç«‹åˆ†åŒ…è¿è¡Œæ—¶ï¼ŒAppå¹¶ä¸ä¸€å®šè¢«æ³¨å†Œï¼Œå› æ­¤ getApp() ä¸ä¸€å®šå¯è·å¾—Appå¯¹è±¡ï¼›ä¸ºäº†åœ¨ç‹¬ç«‹åˆ†åŒ…ä¸­æ»¡è¶³è¿™ä¸€éœ€æ±‚ï¼ŒåŸºç¡€åº“ 2.2.4 ç‰ˆæœ¬å¼€å§‹ getApp æ”¯æŒ [allowDefault] å‚æ•°ï¼Œåœ¨ App æœªå®šä¹‰æ—¶è¿”å›ä¸€ä¸ªé»˜è®¤å®ç°ã€‚å½“ä¸»åŒ…åŠ è½½ï¼ŒApp è¢«æ³¨å†Œæ—¶ï¼Œé»˜è®¤å®ç°ä¸­å®šä¹‰çš„å±æ€§ä¼šè¢«è¦†ç›–åˆå¹¶åˆ°çœŸæ­£çš„ App ä¸­ã€‚
  ```js
    //ç‹¬ç«‹åˆ†åŒ…ä¸­ï¼š
    const app = getApp({allowDefault: true}) // {}
    app.data = 456
    app.global = {}
    //app.jsä¸­ï¼š
    App({
      data: 123,
      other: 'hello'
    })
    console.log(getApp()) // {global: {}, data: 456, other: 'hello'}
  ```

### è°ƒè¯•å°ç¨‹åº

- vConsole:æ‰‹æœºæŸ¥çœ‹ console API è¾“å‡ºçš„æ—¥å¿—å†…å®¹å’Œé¢å¤–çš„è°ƒè¯•ä¿¡æ¯
- Source Map:è¿˜åŸ JS é”™è¯¯å †æ ˆ
- çœŸæœºè°ƒè¯•
- å®æ—¶æ—¥å¿—ï¼šé‡å†™log, ä½¿ç”¨`wx.getRealtimeLogManager`å°è£…ï¼Œåœ¨è¿è¥åå°`å¼€å‘=>å¼€å‘ç®¡ç†=>è¿ç»´ä¸­å¿ƒ=>å®æ—¶æ—¥å¿—`æŸ¥çœ‹

### å…¼å®¹ç‰ˆæœ¬

```js
// 1. ç‰ˆæœ¬å·æ¯”è¾ƒ
const version = wx.getSystemInfoSync().SDKVersion
if(compareVersion(version,'1.1.0') >= 0){
  wx.openBluetoothAdapter()
}else{
  // å¦‚æœå¸Œæœ›ç”¨æˆ·åœ¨æœ€æ–°ç‰ˆæœ¬çš„å®¢æˆ·ç«¯ä¸Šä½“éªŒæ‚¨çš„å°ç¨‹åºï¼Œå¯ä»¥è¿™æ ·å­æç¤º
  wx.showModal({
    title:'æç¤º',
    content:'å½“å‰å¾®ä¿¡ç‰ˆæœ¬è¿‡ä½ï¼Œæ— æ³•ä½¿ç”¨è¯¥åŠŸèƒ½ï¼Œè¯·å‡çº§åˆ°æœ€æ–°å¾®ä¿¡ç‰ˆæœ¬åé‡è¯•ã€‚'
  })
}
// 2. APIæ˜¯å¦å­˜åœ¨
if(wx.openBluetoothAdapter){
  wx.openBluetoothAdapter()
}else{
  // å¦‚æœå¸Œæœ›ç”¨æˆ·åœ¨æœ€æ–°ç‰ˆæœ¬çš„å®¢æˆ·ç«¯ä¸Šä½“éªŒæ‚¨çš„å°ç¨‹åºï¼Œå¯ä»¥è¿™æ ·å­æç¤º
   wx.showModal({
    title:'æç¤º',
    content:'å½“å‰å¾®ä¿¡ç‰ˆæœ¬è¿‡ä½ï¼Œæ— æ³•ä½¿ç”¨è¯¥åŠŸèƒ½ï¼Œè¯·å‡çº§åˆ°æœ€æ–°å¾®ä¿¡ç‰ˆæœ¬åé‡è¯•ã€‚'
  })
}
// 3. wx.canIUse
wx.showModal({
  success:function(res){
    if(wx.canIUse('showModal.success.cancel')){
      console.log(res.cancel)
    }
  }
})
// 4. è®¾ç½®æœ€ä½åŸºç¡€åº“ç‰ˆæœ¬:è¿è¥åå°è®¾ç½®æœ€ä½åŸºç¡€åº“ç‰ˆæœ¬
https://developers.weixin.qq.com/miniprogram/dev/framework/compatibility.html
```
## äºŒã€æ¡†æ¶

[å®˜æ–¹æ–‡æ¡£](https://developers.weixin.qq.com/miniprogram/dev/reference/)

### å°ç¨‹åºé…ç½®

1. å…¨å±€é…ç½®ï¼šapp.jsonï¼›

2. é¡µé¢é…ç½®:pagaé¡µé¢å¯¹åº”çš„ json æ–‡ä»¶ï¼Œæƒé‡æœ€é«˜ï¼›

3. sitemapé…ç½®ï¼šæ ¹ç›®å½•ä¸‹sitemap.json,é…ç½®å…¶å°ç¨‹åºé¡µé¢æ˜¯å¦å…è®¸å¾®ä¿¡ç´¢å¼•ï¼ˆå°ç¨‹åºå†…æœç´¢ï¼‰

### æ¡†æ¶æ¥å£

#### å°ç¨‹åº App
1. Appï¼šå¿…é¡»åœ¨`app.js`ä¸­è°ƒç”¨ï¼Œä¸”`åªèƒ½è°ƒç”¨ä¸€æ¬¡`ï¼š<br>onLaunchã€onShowã€onHideã€onErrorã€onPageNotFoundã€onUnhandledRejectionã€onThemeChangeã€å…¶ä»–ï¼ˆå¯æ·»åŠ ä»»æ„çš„å‡½æ•°æˆ–æ•°æ®å˜é‡åˆ°Objectå‚æ•°ä¸­ï¼Œapp.jsç”¨thiså¯ä»¥è®¿é—®ï¼Œ<u>éåŸç”Ÿäº‹ä»¶ä¸è¦ç”¨onå®šä¹‰</u>ï¼‰

2. getAppï¼šå¤–éƒ¨è®¿é—®Appä¸­çš„æ•°æ®çš„æ–¹å¼

#### é¡µé¢
1. åœ¨é¡µé¢çº§åˆ«çš„ app.js:  
  ![](https://cetacea-1304984885.cos.ap-shanghai.myqcloud.com/pieces/Snipaste_2024-03-29_19-53-33.jpg)

2. getCurrentPage:
  è·å–å½“å‰é¡µé¢æ ˆï¼Œæ•°ç»„ä¸­ç¬¬ä¸€ä¸ªå…ƒç´ ä¸ºé¦–é¡µï¼Œæœ€åä¸€ä¸ªå…ƒç´ ä¸ºå½“å‰é¡µé¢ï¼š
    ```js
    //1.è¿›å…¥å°ç¨‹åºéé»˜è®¤é¦–é¡µï¼Œéœ€è¦æ‰§è¡Œå¯¹åº”æ“ä½œ
    onShow(){
      let pages = getCurrentPage()
      if(pages.length==1){...}
    }
    //2.è·¨é¡µé¢èµ‹å€¼
    let pages = getCurrentPage()//å½“å‰é¡µé¢æ ˆ
    let prevPage = pages[pages.length - 2]//ä¸Šä¸€é¡µé¢
    prevPage.setData({})//ç»™ä¸Šä¸€é¡µé¢èµ‹å€¼
    //3.é¡µé¢è·³è½¬åè‡ªåŠ¨åˆ·æ–°
    wx.switchTab({
      url:'...',
      sucess:function(e){
        const page = getCurrentPage().pop()//å½“å‰é¡µé¢
        if(page == undefined || page == null) return
        page.onLoad()//å…¶ä»–æ“ä½œ
      }})
    ```
#### è‡ªå®šä¹‰ç»„ä»¶

Componentã€Behavior

#### æ¨¡å—åŒ–

![](https://cetacea-1304984885.cos.ap-shanghai.myqcloud.com/pieces/Snipaste_2024-03-29_20-05-03.jpg)

#### åŸºç¡€åŠŸèƒ½

![](https://cetacea-1304984885.cos.ap-shanghai.myqcloud.com/pieces/Snipaste_2024-03-29_20-05-15.jpg)


### WXML

#### æ•°æ®ç»‘å®š
![](https://cetacea-1304984885.cos.ap-shanghai.myqcloud.com/pieces/Snipaste_2024-03-29_20-09-27.jpg)
#### åˆ—è¡¨æ¸²æŸ“
  ```vue
  <!--é»˜è®¤æ•°ç»„å½“å‰é¡¹çš„ä¸‹æ ‡å˜é‡åindexï¼Œé¡¹item-->
  <view wx:for="{{array}}">
    {{index}}:{{item.message}}
  </view>
  <!--æ‰‹åŠ¨æŒ‡å®šï¼š-->
  <view wx:for="{{array}}" wx:for-index='idx' wx:for-item="itemName">
    {{idx}}:{{itemName.message}}
  </view>
  Page({
    data:[{message:'a'},{message:'b'}]
  })
  <!--é‡å¤æ¸²æŸ“ä»£ç å—-->
  <block wx:for="{{[2,3,4]}}">{{index}}:{{item}}</block>
  ```
#### æ¡ä»¶æ¸²æŸ“
```vue
  <view wx:if="{{length>5}}">1</view>
  <view wx:elif="{{length>2}}">2</view>
  <view wx:else>3</view>
  <!--block-->
  <block wx:if="{{true}}">1823</block>
  <!--wx:if vs hidden-->
  <view hidden="{{!flag}}"></view>
  wx:if æœ‰æ›´é«˜çš„åˆ‡æ¢æ¶ˆè€—è€Œ hidden æœ‰æ›´é«˜çš„åˆå§‹æ¸²æŸ“æ¶ˆè€—
  å› æ­¤ï¼Œè‹¥éœ€é¢‘ç¹åˆ‡æ¢ç”¨hiddenæ›´å¥½ï¼›è‹¥æ²¡ä»€ä¹ˆå˜åŒ–ç”¨wx:if
  ```
#### æ¨¡æ¿
#### å¼•ç”¨

### WXS


