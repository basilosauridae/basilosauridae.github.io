---
title: React ç›¸å…³
date: 2024-01-01
tags:
  - react
categories:
  - å‰ç«¯å¼€å‘
---

## åœ¨ react ä¸­å€ŸåŠ© proxy å®ç° Vue3 çš„ reactive

```ts
import React,{ useState } from 'react'
//proxyæ˜¯ä»£ç†ä¸€ä¸ªå¯¹è±¡ï¼Œåšå¯¹è±¡çš„å±æ€§åŠ«æŒ
function UseReactive(initialState){
  const [ state,setState ] = useState(initialState)
  //å€ŸåŠ©å‰¯ä½œç”¨
  useEffect(() => {
    //proxy handler
    const handler = {
      get(target,property){
        return target[property]
      },
      set(target,property,value){
        setState({...target})
        return true
      }
    }
    initialState = new Proxy(initialState,handler)
  },[])
}
function App(){
  const state = UseReactive({count:1})
  state.count += 1
}
```
- æ‹“å±•:æ¨¡æ‹Ÿ Vue3 ä¸­ç»„ä»¶çš„çŠ¶æ€
```html
<html>
<div id="app">{{count}}</div>
<button id="btn">click</button>
</html>
<body><script>
const data = { count:0 }
//å°†è¿™ä¸ªçŠ¶æ€å˜æˆå“åº”å¼,Vue2ä¸­æ˜¯é€šè¿‡ Object.definePropertyï¼ŒVue3æ˜¯Proxy
const reactiveData = new Proxy(data,{
  set(target,property,value){
    target[property] = value
    updateView()
    //updateViewç­‰ä»·äº Vue çš„ new Vue({data:{count:0}}).$mount('#app')
    //è¿™æ˜¯æ¯”è¾ƒç¬¨çš„æ–¹æ³•ï¼Œå› ä¸ºåœ¨å±æ€§ä¸­æ“ä½œï¼ŒVueæºç ç”¨æ”¶é›†ä¾èµ–ä»£æ›¿äº†è¿™ä¸€æ­¥ğŸš©
    return true
  },
  get(target,property){
    return target[property]
  }
})
//æ›´æ–°è§†å›¾
const updateView = () => {
  document.querySelector("#app").innerHTML = reactiveData.count
}
//ä½¿ç”¨
const btnDom = document.querySelector("#btn")
btnDom.addEventListener("click",()=>{
  reactiveData.count ++
})
</script></body>
```

## useSyncExternaStore å°† react å’Œ redux çŠ¶æ€è”ç³»

[useSyncExternaStore](https://zh-hans.react.dev/reference/react/useSyncExternalStore) æ˜¯ä¸€ä¸ªè®©ä½ è®¢é˜…å¤–éƒ¨ store çš„ React Hook.

é™¤äº† proxy, useSyncExternaStoreä¹Ÿå¯ä»¥å®ç°ä¸Šè¿°é—®é¢˜ã€‚