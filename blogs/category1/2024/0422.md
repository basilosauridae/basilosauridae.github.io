---
title: æ¨¡å—åŒ–å¼€å‘ã€webpackã€‘
date: 2024/04/22
tags:
  - å·¥ç¨‹åŒ–
categories:
  - æ€»ç»“
---
## å‰ç½®æ¼”ç»ƒ

### 1.åˆå§‹åŒ–

å…ˆå‡†å¤‡ä¸€ä¸ªfileï¼Œ`npm init -y`åˆå§‹åŒ–ï¼Œ`package.json`ä¸­æ·»åŠ :
```json
"devDependencies": {
  "webpack":"5.91.0",
  "webpack-cli": "5.1.4"
}
```
### 2.æ·»åŠ entryï¼Œæ€è€ƒé—®é¢˜ï¼šğŸš©ä¸ºä»€ä¹ˆè¦æ‰“åŒ…æ„å»ºï¼š

- è½¬æ¢æ–‡ä»¶ï¼Œä»¥è·å¾—æ›´å¥½çš„å…¼å®¹æ€§ï¼ˆbabelå’Œcore-jsæ¥[polyfill](/docs/guide/noun.html#polyfill)ï¼‰ï¼›
- å°†ä¼—å¤šèµ„æºï¼ˆjsã€cssã€imgã€fontï¼‰åˆå¹¶ï¼ŒæŒ‰éœ€ä½¿ç”¨ï¼›
- äº§ç‰©è¿›è¡Œä¼˜åŒ–ï¼Œä»£ç å‹ç¼©ã€ä»£ç ä¸‘åŒ–ï¼Œå‡å°‘æ–‡ä»¶ä½“ç§¯å’Œæºç å®‰å…¨ã€‚

### 3.æ·»åŠ output

- `webpack.config.js`æ·»åŠ outputï¼Œå¹¶è¿è¡Œ`npm install`
```json
output:{
  filename:"bundle.js",
  path:__dirname + "/dist",
  clear:true,//æ¯æ¬¡æ‰“åŒ…æ¸…é™¤æ—§çš„åŒ…
  environment:{}//æ‰“åŒ…æ—¶æ”¯æŒçš„ç¯å¢ƒç‰¹æ€§
}
```
- åœ¨ package.json ä¸­æ·»åŠ  `"build":"webpack"`ï¼Œè¿è¡Œ`npm run build`ï¼Œé¡¹ç›®ä¸‹ç”Ÿæˆäº†`dist/bundle.js`å°±æ˜¯å‡ºå£æ–‡ä»¶ã€‚
```json
"scripts": {
  "build":"webpack"
},
```

### 4.æ·»åŠ module
- moduleä¸­æ˜¯å…³äº**JSã€CSSã€å›¾ç‰‡ã€å­—ä½“æ–‡ä»¶**éƒ½éœ€è¦åŠ å·¥çš„æ¨¡å—çš„ä¸åŒè§„åˆ™

1ï¸âƒ£ ã€**JS**ã€‘moduleä¸­çš„[babel-loader](https://www.babeljs.cn/docs/)ï¼Œæœ‰ä¸¤ç§é…ç½®æ–¹å¼ï¼šğŸš—

ğŸš— é…ç½®æ–¹å¼ä¸€ï¼š
```js
 module:{
  rules:[{//é’ˆå¯¹äºjsçš„å¤„ç†
    test:/\.js/,
    use:{
      loader:"babel-loader",//å°†babelå’Œwebpackè¿›è¡Œæ¡¥æ¥çš„åŠ è½½å™¨
      options:{presets:["@babel/preset-env","@babel/preset-typescript"]}}}]}
```
ğŸš— é…ç½®æ–¹å¼äºŒï¼šé¡¹ç›®æ ¹ç›®å½•ä¸‹é…ç½®.babelrcï¼šä»¥ä¸‹è¿™äº›presetsä¹Ÿéœ€å®‰è£…å¯¹åº”åŸºæœ¬ä¾èµ–
:::: code-group
::: code-group-item .babelrcæ–‡ä»¶

```js
{ // babel presetsæ˜¯å¹²å˜›çš„ï¼Ÿå®˜ç½‘ => https://www.babeljs.cn/docs/presets
  // babel presetsæ˜¯ä¸€ç³»åˆ—æ’ä»¶çš„é›†åˆé¢„è®¾ğŸ§­ï¼Œè¿™äº›æ’ä»¶ç”¨æ¥è½¬æ¢ ES6/ES7/ES8 åˆ° ES5
  "presets": [
    "@babel/preset-env",//è½¬æ¢pluginsçš„å°è£…
    "@babel/preset-typescript"//è½¬æ¢tsçš„å¤„ç†
]}
```

:::
::: code-group-item package.json

```json
"devDependencies": {
    ...
    "babel-loader": "9.1.3",
    "@babel/core": "7.24.3",
    "@babel/preset-env": "7.24.3",
    "@babel/preset-typescript": "7.24.1"
  }
```
:::
::::

2ï¸âƒ£ ã€**CSS**ã€‘moduleä¸­ css-loader å’Œ [mini-css-extract-plugin](https://webpack.js.org/plugins/mini-css-extract-plugin/)çš„ç»“åˆä½¿ç”¨,æ‰“åŒ…äº§ç‰©è®©csså’Œjsåˆ†ç¦»ã€‚

ä½¿ç”¨åœºæ™¯ï¼šéœ€è¦å•ç‹¬æå–cssæ ·å¼ï¼Œå¼€å‘çš„æ˜¯é€šç”¨æ¨¡å—ï¼Œå®ç°cssé«˜åº¦å¤ç”¨ã€‚

:::: code-group
::: code-group-item webpack.config.js

```js
const MiniCssExtractPlugin = require("mini-css-extract-plugin");
module.exports = {
  plugins: [new MiniCssExtractPlugin()],
  module: {
    rules: [{ 
      test: /\.css$/i,
      use: [MiniCssExtractPlugin.loader, "css-loader"]}
]}}
```
:::
::: code-group-item package.json

```json
"devDependencies": {
    ...
    "css-loader": "6.10.0",
    "style-loader": "3.3.4",
    "mini-css-extract-plugin": "2.8.1",
  }
```
:::
::::

### 5.mode:`webpack5`å¿…é¡»æŒ‡å®šmode,å¦åˆ™æ‰“åŒ…ä¼šæŠ¥é”™

![](https://cetacea-1304984885.cos.ap-shanghai.myqcloud.com/pieces/Snipaste_2024-04-22_19-44-39.jpg)

### 6.optimizationçš„splitChunksä¼˜åŒ–

[OptimizationWebpack](https://webpack.js.org/configuration/optimization/)æ ¹æ®é€‰æ‹©çš„æ¨¡å¼è¿è¡Œä¼˜åŒ–ï¼Œä½†æ‰€æœ‰ä¼˜åŒ–éƒ½å¯ç”¨äºæ‰‹åŠ¨é…ç½®å’Œè¦†ç›–ã€‚splitChunksæ˜¯å…¶ä¸­ä¹‹ä¸€ã€‚

```js
output:{
  filename: "[name].[contenthash].js"
  // é™¤äº†contenthashï¼Œè¿˜æœ‰ hashã€chunkhash
},
 optimization: {
    splitChunks: {
      minChunks: 2,
      maxSize: 20 * 1024,
      cacheGroups: {
        commons: {
          test: /[\\/]node_modules[\\/]/,
          // cacheGroupKey here is `commons` as the key of the cacheGroup
          name(module, chunks, cacheGroupKey) {
            console.log("ğŸš€ ~ name ~ chunks:", chunks);
            const moduleFileName = module
              .identifier()
              .split("/")
              .reduceRight((item) => item);
            const allChunksNames = chunks.map((item) => item.name).join("~");
            return `${cacheGroupKey}-${allChunksNames}-${moduleFileName}`;
          },
          chunks: "all",
        },
        defaultVendors: {
          test: /vender/,
          priority: -10,
          reuseExistingChunk: true,
        },
        default: {
          minChunks: 2,
          priority: -20,
          reuseExistingChunk: true,
  }}}}
```

> ğŸš©**chunksè¢«åˆ‡åˆ†å¾—å´å¤šå°±è¶Šå¥½å—**?å…¶å®ä¸æ˜¯ï¼Œåˆ‡åˆ†å¾—è¶Šå¤šï¼Œæ‰“åŒ…äº§ç‰©æ–‡ä»¶è¶Šå¤šï¼Œè¯·æ±‚å°±è¶Šå¤šï¼›åˆ†å‰²chunk,éœ€è¦è€ƒè™‘æ–‡ä»¶å¤§å°å’Œè¯·æ±‚æ•°ç­‰ç»¼åˆæƒ…å†µã€‚ 

## webpack æ ¸å¿ƒé…ç½®

### 1.Entry

ğŸ›´å…¥å£ï¼Œwebpackæ‰§è¡Œæ„å»ºçš„ç¬¬ä¸€æ­¥å°†ä»æ­¤å¼€å§‹ã€‚

> å…³äºä»¥ä¸‹å†…å®¹ å¹¶ä¸æ˜¯æ‰€æœ‰çš„éƒ½å±äºentryå¯¹è±¡é‡Œçš„å†…å®¹ï¼Œè€Œæ˜¯å’Œå…¶ç›¸å…³è”çš„éƒ¨åˆ†

- contextï¼šwebpackåœ¨å¯»æ‰¾ç›¸å¯¹è·¯å¾„çš„æ–‡ä»¶æ—¶ä¼šä»¥ context ä¸ºæ ¹ç›®å½•ï¼Œcontext é»˜è®¤ä¸ºæ‰§è¡Œå¯åŠ¨ webpack æ—¶æ‰€åœ¨çš„å½“å‰çš„å·¥ä½œç›®å½•ã€‚è‹¥æƒ³æ”¹å˜ context çš„é»˜è®¤é…ç½®ï¼Œå¯è®¾ç½®ï¼š
  ```js
  module.exports = {
    context: path.resolve(__dirname, 'app')
  }
  //Entry çš„è·¯å¾„å’Œå…¶ä¾èµ–çš„æ¨¡å—çš„è·¯å¾„å¯èƒ½é‡‡ç”¨ç›¸å¯¹äº context çš„è·¯å¾„æ¥æè¿°ï¼Œ
  //context ä¼šå½±å“åˆ°è¿™äº›ç›¸å¯¹è·¯å¾„æ‰€æŒ‡å‘çš„çœŸå®æ–‡ä»¶ã€‚
  ```
- entryï¼šğŸš©å¿…å¡«é¡¹ï¼Œwebpackæ‰§è¡Œæ„å»ºçš„ç¬¬ä¸€æ­¥å°†ä»å…¥å£å¼€å§‹æœå¯»åŠ**é€’å½’è§£æ**æ‰€æœ‰å…¥å£ä¾èµ–çš„æ¨¡å—ï¼š<i>(ä¹Ÿå¯ä»¥è§£é‡Švueé¡¹ç›®ä¸­ä¸ºä»€ä¹ˆmain.jsä¸ºå…¥å£æ–‡ä»¶ï¼Œå¼•å…¥äº†æ‰€æœ‰ä¾èµ–)</i>

  ```js
  // å…¥å£æ¨¡å—çš„æ–‡ä»¶è·¯å¾„
  // å•ä¸ªæ–‡ä»¶ä¹Ÿå¯ ä»¥å­—ç¬¦ä¸²å½¢å¼å±•ç°'xx'ï¼›
  // æ•°ç»„['xx','xx'...],åˆ™æ­é… output.library é…ç½®é¡¹ä½¿ç”¨æ—¶ï¼Œåªæœ‰ğŸš©æ•°ç»„é‡Œçš„æœ€åä¸€ä¸ªå…¥å£æ–‡ä»¶çš„æ¨¡å—ä¼šè¢«å¯¼å‡º;
  // å¯¹è±¡ç±»å‹é…ç½®å¤šä¸ªå…¥å£ï¼Œæ¯ä¸ªå…¥å£ç”Ÿæˆä¸€ä¸ªchunkï¼š
  entry:{ 
    main:"./src/index.ts",
    vendor:'./src/vendor.ts'
  },
  ```
- Chunkåç§°ï¼šwebpack ä¼šä¸ºæ¯ä¸€ä¸ªç”Ÿæˆçš„ Chunk å–ä¸€ä¸ªåç§°ï¼ŒChunk çš„åç§°å’Œ Entry çš„é…ç½®æœ‰å…³ï¼š
  1. è‹¥ entry æ˜¯ string/array,åªä¼šç”Ÿæˆä¸€ä¸ª chunk (æ‰“åŒ…åçš„äº§ç‰©)ï¼Œæ­¤æ—¶chunkçš„åç§°æ˜¯ mainï¼›
  2. è‹¥ entry æ˜¯ Object,ä¼šå‡ºç°å¤šä¸ª chunk,æ­¤æ—¶chunkçš„åç§°æ˜¯ Object é‡Œé”®å€¼å¯¹çš„é”®çš„åç§°ã€‚

- åŠ¨æ€é…ç½® Entryï¼šé’ˆå¯¹é¡¹ç›®ä¸­ï¼Œå¤šä¸ªé¡µé¢éœ€è¦ä¸ºæ¯ä¸ªé¡µé¢çš„å…¥å£é…ç½®ä¸€ä¸ª Entry,ä¸”è¿™äº›é¡µé¢å¯èƒ½ä¸æ–­å¢é•¿çš„æƒ…å†µï¼š
  ```js
  // åŒæ­¥å‡½æ•°
  entry: () => {
    return {
      a:'./pages/a',
      b:'./pages/b',
    }
  };
  // å¼‚æ­¥å‡½æ•°
  entry: () => {
    return new Promise((resolve)=>{
      resolve({
        a:'./pages/a',
        b:'./pages/b',
      })
    })
  }
  ```

### 2.Output

- filename:åªè¾“å‡ºä¸€ä¸ªï¼Œé™æ€å­—ç¬¦ä¸²ç±»å‹ï¼›å¤šä¸ªchunkè¦è¾“å‡ºï¼Œå€ŸåŠ©æ¨¡æ¿å’Œå˜é‡ï¼›
- è‹¥æƒ³æ‰“åŒ…äº§ç‰©ä¸ºå¤šä¸ªjs,å¯åœ¨webpack.config.jsé…ç½®`entry`å’Œ`output`ï¼›
- outputä¸­çš„`cleanï¼štrue`ï¼Œè®©webpackæ¯æ¬¡æ‰“åŒ…å‰è‡ªåŠ¨æ¸…ç†ä¸Šä¸€æ¬¡æ‰“åŒ…çš„æ–‡ä»¶å¤¹ï¼Œ`clean-webpack-plugin`æœ‰åŒæ ·çš„æ•ˆæœï¼Œä½†è¿™ä¸ªæ’ä»¶æ”¯æŒæ›´ç»†ç²’åº¦åœ°æ§åˆ¶æ¸…ç†è¡Œä¸ºã€‚
```js
output: {
  filename: "[name].[contenthash].js",
  // [name].js chunkçš„åç§°
  // id chunkçš„å”¯ä¸€æ ‡è¯† ä»0å¼€å§‹
  // hash é’ˆå¯¹æ–‡ä»¶æœ¬èº«
  // contenthash é’ˆå¯¹æ–‡ä»¶å†…å®¹
  // chunkhash
  /*ğŸš©
  hash æ˜¯å…¨å±€æ€§çš„ï¼Œå—åˆ°æ„å»ºè¿‡ç¨‹ä¸­æ‰€æœ‰æ–‡ä»¶çš„å½±å“ï¼›
  chunkhash æ˜¯é’ˆå¯¹å•ä¸ª chunk å†…éƒ¨æ–‡ä»¶çš„ï¼Œåªæœ‰å‘ç”Ÿå˜åŒ–çš„ chunk çš„ chunkhash ä¼šå˜åŒ–ï¼›
  contenthash æ˜¯é’ˆå¯¹å•ä¸ªæ–‡ä»¶å†…å®¹çš„ï¼Œåªæœ‰æ–‡ä»¶å†…å®¹å‘ç”Ÿå˜åŒ–æ—¶ï¼Œå¯¹åº”çš„contenthashæ‰ä¼šå˜åŒ–ã€‚
  */
 clean:true
},
entry: {
  main: "./src/index.ts",
  vendor: "./src/vendor.ts",
},
```
- è¿˜æœ‰chunkFilenameã€pathã€publicPathã€crossOriginLoadingã€library/libraryTargetã€libraryExportç­‰åŸºç¡€é…ç½®ï¼Œè¯¦æƒ…è§[å®˜ç½‘](https://webpack.js.org/configuration/output/)

### 3.Module

ğŸ›´æ¨¡å—ï¼Œwebpackä¸­ä¸€ä¸ªæ¨¡å—å¯¹åº”ä¸€ä¸ªæ–‡ä»¶ï¼Œä»Entryå¼€å§‹é€’å½’æ‰¾å‡ºæ‰€æœ‰ä¾èµ–çš„æ¨¡å—ã€‚

- module é…ç½®å¦‚ä½•å¤„ç†æ¨¡å—ï¼Œ**module.rules**é…ç½®æ¨¡å—çš„è¯»å–å’Œè§£æè§„åˆ™ï¼Œé€šå¸¸ç”¨æ¥é…ç½®**Loader**ï¼š

  1. é€šè¿‡testã€includeã€excludeä¸‰ä¸ªé…ç½®é¡¹å‘½ä¸­ Loader è¦åº”ç”¨è§„åˆ™çš„æ–‡ä»¶ï¼›
  2. åº”ç”¨è§„åˆ™ï¼šå¯¹é€‰ä¸­çš„æ–‡ä»¶é€šè¿‡ use é…ç½®é¡¹æ¥åº”ç”¨ Loader,å¯ä»¥åªåº”ç”¨ä¸€ä¸ª Loader æˆ–è€…æŒ‰ç…§ä»åå¾€å‰çš„é¡ºåºåº”ç”¨ä¸€ç»„ Loaderï¼ŒåŒæ—¶è¿˜å¯ä»¥åˆ†åˆ«ç»™ Loader ä¼ å…¥å‚æ•°ï¼›
  3. é‡ç½®é¡ºåºï¼šä¸€ç»„ Loader çš„æ‰§è¡Œé¡ºåºæ˜¯ä»å³åˆ°å·¦æ‰§è¡Œï¼Œé€šè¿‡ enforce é€‰é¡¹å¯ä»¥è®©å…¶ä¸­ä¸€ä¸ª Loader çš„æ‰§è¡Œé¡ºåºæ”¾åˆ°æœ€å‰æˆ–æœ€å
  ```js
  module: {
    rules: [
      {
        // å‘½ä¸­ JavaScript æ–‡ä»¶
        test: /\.js$/,
        // ç”¨ babel-loader è½¬æ¢ JavaScript æ–‡ä»¶
        // ?cacheDirectory è¡¨ç¤ºä¼ ç»™ babel-loader çš„å‚æ•°ï¼Œç”¨äºç¼“å­˜ babel ç¼–è¯‘ç»“æœåŠ å¿«é‡æ–°ç¼–è¯‘é€Ÿåº¦
        use: ['babel-loader?cacheDirectory'],
        // åªå‘½ä¸­srcç›®å½•é‡Œçš„jsæ–‡ä»¶ï¼ŒåŠ å¿« Webpack æœç´¢é€Ÿåº¦
        include: path.resolve(__dirname, 'src')
      },
      {
        // å‘½ä¸­ SCSS æ–‡ä»¶
        test: /\.scss$/,
        // ä½¿ç”¨ä¸€ç»„ Loader å»å¤„ç† SCSS æ–‡ä»¶ã€‚
        // å¤„ç†é¡ºåºä¸ºä»ååˆ°å‰ï¼Œå³å…ˆäº¤ç»™ sass-loader å¤„ç†ï¼Œå†æŠŠç»“æœäº¤ç»™ css-loader æœ€åå†ç»™ style-loaderã€‚
        use: ['style-loader', 'css-loader', 'sass-loader'],
        // æ’é™¤ node_modules ç›®å½•ä¸‹çš„æ–‡ä»¶
        exclude: path.resolve(__dirname, 'node_modules'),
      },
      {
        // å¯¹éæ–‡æœ¬æ–‡ä»¶é‡‡ç”¨ file-loader åŠ è½½
        test: /\.(gif|png|jpe?g|eot|woff|ttf|svg|pdf)$/,
        use: ['file-loader'],
      },
    ]
  }
  ```
  4. åœ¨ Loader éœ€è¦ä¼ å…¥å¾ˆå¤šå‚æ•°æ—¶ï¼Œä½ è¿˜å¯ä»¥é€šè¿‡ä¸€ä¸ª Object æ¥æè¿°ï¼Œä¾‹å¦‚åœ¨ä¸Šé¢çš„ babel-loader é…ç½®ä¸­æœ‰å¦‚ä¸‹ä»£ç ï¼š
  ```js
  use: [
    {
      loader:'babel-loader',
      options:{
        cacheDirectory:true,
      },
      // enforce:'post' çš„å«ä¹‰æ˜¯æŠŠè¯¥ Loader çš„æ‰§è¡Œé¡ºåºæ”¾åˆ°æœ€å
      // enforce çš„å€¼è¿˜å¯ä»¥æ˜¯ preï¼Œä»£è¡¨æŠŠ Loader çš„æ‰§è¡Œé¡ºåºæ”¾åˆ°æœ€å‰é¢
      enforce:'post'
    },
    // çœç•¥å…¶å®ƒ Loader
  ]
  ```
  5. ä¸Šé¢çš„ä¾‹å­ä¸­ test include exclude è¿™ä¸‰ä¸ªå‘½ä¸­æ–‡ä»¶çš„é…ç½®é¡¹åªä¼ å…¥äº†ä¸€ä¸ªå­—ç¬¦ä¸²æˆ–æ­£åˆ™ï¼Œå…¶å®å®ƒä»¬è¿˜éƒ½æ”¯æŒæ•°ç»„ç±»å‹ï¼Œä½¿ç”¨å¦‚ä¸‹ï¼š
  ```js
  {
    test:[
      /\.jsx?$/,
      /\.tsx?$/
    ],
    include:[
      path.resolve(__dirname, 'src'),
      path.resolve(__dirname, 'tests'),
    ],
    exclude:[
      path.resolve(__dirname, 'node_modules'),
      path.resolve(__dirname, 'bower_modules'),
    ]
  }
  ```
- **module.noParse**ï¼šwebpackçš„æ€§èƒ½ä¼˜åŒ–ï¼Œè®©webpackå¿½ç•¥ å¯¹éƒ¨åˆ†æ²¡é‡‡ç”¨ æ¨¡å—åŒ–çš„æ–‡ä»¶çš„ é€’å½’è§£æå’Œå¤„ç†ï¼Œæé«˜æ„å»ºæ€§èƒ½ã€‚å¦‚jQueryã€ChartJsåº“ï¼Œå®ƒä»¬åºå¤§åˆæ²¡æœ‰é‡‡ç”¨æ¨¡å—åŒ–æ ‡å‡†ï¼Œè®©webpackå»è§£æè€—æ—¶åˆæ²¡æœ‰æ„ä¹‰ã€‚ğŸŒ¸
  ```js
  moduleï¼š{
    // noParse æ˜¯å¯é€‰é…ç½®é¡¹ï¼Œç±»å‹éœ€è¦æ˜¯ RegExpã€[RegExp]ã€function å…¶ä¸­ä¸€ä¸ª
    // 1.ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼
    noParse: /jquery|chartjs/
    // 2.ä½¿ç”¨å‡½æ•°ï¼Œä» Webpack 3.0.0 å¼€å§‹æ”¯æŒ
    noParse: (content)=> {
      // content ä»£è¡¨ä¸€ä¸ªæ¨¡å—çš„æ–‡ä»¶è·¯å¾„
      // è¿”å› true or false
      return /jquery|chartjs/.test(content);
    }
  }
  ```
  > tips:è¢«å¿½ç•¥çš„æ–‡ä»¶é‡Œä¸åº”è¯¥åŒ…å«`import`ã€`require`ã€`define`ç­‰æ¨¡å—åŒ–è¯­å¥ï¼Œå¦åˆ™ä¼šå¯¼è‡´æ„å»ºå‡ºæ¥çš„ä»£ç ä¸­åŒ…å«æ— æ³•åœ¨æµè§ˆå™¨ç¯å¢ƒä¸‹æ‰§è¡Œçš„æ¨¡å—åŒ–è¯­å¥ã€‚

- **module.parser**:ç”±äºwebpackæ˜¯ä»¥æ¨¡å—åŒ–çš„jsæ–‡ä»¶ä¸ºå…¥å£ï¼Œæ‰€ä»¥å†…ç½®äº†å¯¹æ¨¡å—åŒ–jsçš„è§£æåŠŸèƒ½ï¼Œæ”¯æŒ AMDã€CommonJSã€SystemJSã€ES6.`parser`å¯ä»¥æ›´ç»†ç²’åº¦çš„é…ç½®å“ªäº›æ¨¡å—è¯­æ³•æ˜¯å¦éœ€è¦è§£æã€‚å’Œ`noParse`çš„åŒºåˆ«åœ¨äº,`parser`å¯ä»¥ç²¾ç¡®åˆ°è¯­æ³•å±‚é¢ï¼Œ`noParse`åªèƒ½æ§åˆ¶å“ªäº›æ–‡ä»¶ä¸è¢«è§£æã€‚
  ```js
  module: {
    rules: [
      {
        test: /\.js$/,
        use: ['babel-loader'],
        parser: {
          amd: false, // ç¦ç”¨ AMD
          commonjs: false, // ç¦ç”¨ CommonJS
          system: false, // ç¦ç”¨ SystemJS
          harmony: false, // ç¦ç”¨ ES6 import/export
          requireInclude: false, // ç¦ç”¨ require.include
          requireEnsure: false, // ç¦ç”¨ require.ensure
          requireContext: false, // ç¦ç”¨ require.context
          browserify: false, // ç¦ç”¨ browserify
          requireJs: false, // ç¦ç”¨ requirejs
        }
      }
  ]}
  ```

### 4.Plugin

ğŸ›´æ‰©å±•æ’ä»¶ï¼ŒWebpack é€šè¿‡ Plugin æœºåˆ¶è®©å…¶æ›´åŠ çµæ´»ï¼Œä»¥é€‚åº”å„ç§åº”ç”¨åœºæ™¯ã€‚ åœ¨ Webpack è¿è¡Œçš„ç”Ÿå‘½å‘¨æœŸä¸­ä¼šå¹¿æ’­å‡ºè®¸å¤šäº‹ä»¶ï¼ŒPlugin å¯ä»¥ç›‘å¬è¿™äº›äº‹ä»¶ï¼Œåœ¨åˆé€‚çš„æ—¶æœºé€šè¿‡ Webpack æä¾›çš„ API æ”¹å˜è¾“å‡ºç»“æœã€‚

### 5.Loader

ğŸ›´æ¨¡å—è½¬åŒ–å™¨ï¼Œç”¨äºæŠŠæ¨¡å—åŸå†…å®¹æŒ‰ç…§éœ€æ±‚è½¬åŒ–æˆæ–°å†…å®¹ã€‚

### 6.Chunk

ğŸ›´ä»£ç å—ï¼Œä¸€ä¸ªChunkç”±å¤šä¸ªæ¨¡å—ç»„åˆè€Œæˆï¼Œç”¨äºä»£ç åˆå¹¶å’Œåˆ†å‰²ã€‚

### 7.Resolve

webpackåœ¨å¯åŠ¨åä¼šä»é…ç½®çš„å…¥å£æ¨¡å—å‡ºå‘æ‰¾å‡ºæ‰€æœ‰ä¾èµ–çš„æ¨¡å—ï¼ŒResolveåˆ™é…ç½®webpackå¦‚ä½•å¯»æ‰¾æ¨¡å—æ‰€å¯¹åº”çš„æ–‡ä»¶ã€‚Webpackå†…ç½®JSæ¨¡å—åŒ–è¯­æ³•è§£æçš„åŠŸèƒ½ï¼Œé»˜è®¤é‡‡ç”¨æ¨¡å—åŒ–æ ‡å‡†é‡Œçº¦å®šå¥½çš„è§„åˆ™å»å¯»æ‰¾ï¼Œç”¨æˆ·ä¹Ÿå¯ä»¥è‡ªå®šä¹‰ä¿®æ”¹è§„åˆ™ã€‚

- `resolve.alias`é€šè¿‡åˆ«åæŠŠåŸå¯¼å…¥è·¯å¾„æ˜ å°„æˆæ–°çš„å¯¼å…¥è·¯å¾„

  ```js
  resolve: {
    alias: {
      "@": __dirname + "/src",//ç±»å‹åˆ«åå®šä¹‰ï¼Œå¼•å…¥æ–‡ä»¶å°±å¯ä»¥ä¸ç”¨./äº†
    },
    // å®šä¹‰äº† webpack å¦‚ä½•è‡ªåŠ¨æ·»åŠ åç¼€å
    extensions: [".ts", ".js", ".json"],
  },
  ```
- `resolve.modules`é…ç½®webpackå»å“ªäº›ç›®å½•ä¸‹å¯»æ‰¾ç¬¬ä¸‰æ–¹æ¨¡å—ï¼Œé»˜è®¤æ˜¯åªä¼šå» node_modulesç›®å½•ä¸‹å¯»æ‰¾ã€‚å½“é¡¹ç›®ä¸­æœ‰ä¸€äº›æ¨¡å—å¤§é‡è¢«å…¶ä»–æ¨¡å—ä¾èµ–å’Œå¯¼å…¥ï¼Œç”±äºå…¶ä»–æ¨¡å—çš„ä½ç½®åˆ†å¸ƒä¸å®šï¼Œé’ˆå¯¹ä¸åŒçš„æ–‡ä»¶éƒ½è¦å»è®¡ç®—è¢«å¯¼å…¥æ¨¡å—æ–‡ä»¶çš„ç›¸å¯¹è·¯å¾„ï¼Œè¿™ä¸ªè·¯å¾„å°±ä¼šå¾ˆé•¿ã€‚
  ```js
  //å°±åƒè¿™æ · import '../../../components/button' è¿™æ—¶ä½ å¯ä»¥åˆ©ç”¨ modules é…ç½®é¡¹ä¼˜åŒ–ï¼Œ
  //å‡å¦‚é‚£äº›è¢«å¤§é‡å¯¼å…¥çš„æ¨¡å—éƒ½åœ¨ ./src/components ç›®å½•ä¸‹ï¼ŒæŠŠ modules é…ç½®æˆ:
  resolve:{
    modules:['./src/components','node_modules']
  }
  //ç„¶åï¼Œå°±å¯ä»¥ç®€å•é€šè¿‡ import 'button' å¯¼å…¥ã€‚
  ```
- `resolve.extensions`åœ¨å¯¼å…¥è¯­å¥æ²¡å¸¦æ–‡ä»¶åç¼€æ—¶ï¼ŒWebpack ä¼šè‡ªåŠ¨å¸¦ä¸Šåç¼€åå»å°è¯•è®¿é—®æ–‡ä»¶æ˜¯å¦å­˜åœ¨ã€‚ resolve.extensions ç”¨äºé…ç½®åœ¨å°è¯•è¿‡ç¨‹ä¸­ç”¨åˆ°çš„åç¼€åˆ—è¡¨ï¼Œé»˜è®¤æ˜¯ï¼š
  ```js
  extensions: ['.js', '.json']
  //å½“é‡åˆ° require('./data') è¿™æ ·çš„å¯¼å…¥è¯­å¥æ—¶ï¼ŒWebpack ä¼šå…ˆå»å¯»æ‰¾ ./data.js æ–‡ä»¶ï¼Œ
  //å¦‚æœè¯¥æ–‡ä»¶ä¸å­˜åœ¨å°±å»å¯»æ‰¾ ./data.json æ–‡ä»¶ï¼Œ å¦‚æœè¿˜æ˜¯æ‰¾ä¸åˆ°å°±æŠ¥é”™ã€‚
  //ä¹Ÿå¯è‡ªå®šä¹‰ï¼Œå¦‚ä¸‹ä¼˜å…ˆå¯»æ‰¾tsæ–‡ä»¶ï¼š
  extensions: ['.ts', '.js', '.json']
  ```

### 8.æ€»ç»“

- æƒ³è®©æºæ–‡ä»¶åŠ å…¥åˆ°æ„å»ºæµç¨‹ä¸­è¢« webpack æ§åˆ¶ï¼Œé…ç½® entry;
- æƒ³è‡ªå®šä¹‰è¾“å‡ºæ–‡ä»¶çš„ä½ç½®å’Œåç§°ï¼Œé…ç½® output;
- æƒ³è‡ªå®šä¹‰å¯»æ‰¾ä¾èµ–æ¨¡å—æ—¶çš„ç­–ç•¥ï¼Œé…ç½® resolve;
- æƒ³è‡ªå®šä¹‰è§£æå’Œè½¬æ¢æ–‡ä»¶çš„ç­–ç•¥ï¼Œé…ç½® module,ä¸€èˆ¬æ˜¯module.rules.loader;
- å…¶ä»–å¤§éƒ¨åˆ†éœ€è¦éœ€è¦ plugin å»å®ç°ã€‚

## webpack åŸç†è§£æ

éœ€è¦ä»ä»¥ä¸‹ä¸‰ä¸ªæ–¹ä¾¿ç†è§£ã€‚

### 1.åŸºæœ¬æ¦‚å¿µ

ğŸ›´è¯¦ç»†å‚è€ƒæœ¬æ–‡[webpack-æ ¸å¿ƒé…ç½®](/blogs/category1/2024/0422.html#webpack-æ ¸å¿ƒé…ç½®)

### 2.æµç¨‹æ¦‚æ‹¬

ä¸€ä¸ªä¸²è¡Œçš„è¿‡ç¨‹ï¼Œä¾æ¬¡æ‰§è¡Œ:

![](https://cetacea-1304984885.cos.ap-shanghai.myqcloud.com/pieces/106de06d-5417-45ee-9fc7-d70906598adf.png)

1. åˆå§‹åŒ–å‚æ•°ï¼šä»`é…ç½®æ–‡ä»¶å’ŒShellè¯­å¥`ä¸­è¯»å–å’Œåˆå¹¶å‚æ•°ï¼Œå¾—å‡ºæœ€ç»ˆå‚æ•°ï¼›
2. å¼€å§‹ç¼–è¯‘ï¼šæ ¹æ®æœ€ç»ˆå‚æ•°åˆå§‹åŒ–`Compilerå¯¹è±¡`ï¼ŒåŠ è½½æ‰€æœ‰é…ç½®çš„æ’ä»¶ï¼Œæ‰§è¡Œ`å¯¹è±¡çš„run`æ–¹æ³•å¼€å§‹æ‰§è¡Œç¼–è¯‘ï¼›
3. ç¡®å®šå…¥å£ï¼šæ ¹æ®é…ç½®çš„.`entry`æ‰¾å‡ºæ‰€æœ‰å…¥å£æ–‡ä»¶ï¼›
4. ç¼–è¯‘æ¨¡å—ï¼šä»å…¥å£æ–‡ä»¶å‡ºå‘ï¼Œè°ƒç”¨æ‰€æœ‰é…ç½®çš„`loader`å¯¹æ¨¡å—è¿›è¡Œç¼–è¯‘ï¼Œå†æ‰¾å‡ºå¯¹åº”çš„ä¾èµ–ï¼Œé€’å½’æœ¬æ­¥éª¤ç›´åˆ°æ‰€æœ‰çš„ä¾èµ–éƒ½ç»å†æ­¤æ­¥ï¼›
5. å®Œæˆç¼–è¯‘æ¨¡å—ï¼šå®Œæˆloaderç¼–è¯‘åï¼Œå¾—åˆ°æ¯ä¸ªæ¨¡å—è¢«ç¼–è¯‘çš„æœ€ç»ˆå†…å®¹å’Œå…¶ä¾èµ–å…³ç³»ï¼›
6. è¾“å‡ºèµ„æºï¼šæ ¹æ®å…¥å£å’Œæ¨¡å—ä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼Œç»„è£…æˆä¸€ä¸ªä¸ªåŒ…å«å¤šä¸ªæ¨¡å—çš„`Chunk`,å†æŠŠæ¯ä¸ªChunkè½¬æ¢æˆä¸€ä¸ªå•ç‹¬çš„æ–‡ä»¶åŠ å…¥åˆ°è¾“å‡ºåˆ—è¡¨ï¼Œè¿™æ­¥æ˜¯å¯ä»¥ä¿®æ”¹è¾“å‡ºå†…å®¹çš„æœ€åæœºä¼šï¼›
7. è¾“å‡ºå®Œæˆï¼šåœ¨ç¡®å®šå¥½è¾“å‡ºå†…å®¹åï¼Œæ ¹æ®é…ç½®ç¡®å®šè¾“å‡ºçš„è·¯å¾„å’Œæ–‡ä»¶åï¼ŒæŠŠæ–‡ä»¶å†…å®¹å†™å…¥åˆ°æ–‡ä»¶ç³»ç»Ÿã€‚

### 3.æµç¨‹ç»†èŠ‚
 
## å¸¸è§ Loadersï¼š

### åŠ è½½æ–‡ä»¶

- [raw-loader](https://github.com/webpack-contrib/raw-loader)ï¼šå°†æ–‡æœ¬çš„æ–‡ä»¶å†…å®¹åŠ è½½åˆ°ä»£ç ä¸­ï¼›
- [file-loader](https://github.com/webpack-contrib/file-loader)ï¼šå°†æ–‡ä»¶è¾“å…¥åˆ°ä¸€ä¸ªæ–‡ä»¶å¤¹ä¸­ï¼Œåœ¨ä»£ç ä¸­é€šè¿‡ç›¸å¯¹ URL å»å¼•ç”¨è¾“å‡ºçš„æ–‡ä»¶ï¼›
- [url-loader](https://github.com/webpack-contrib/url-loader)ï¼šå’Œfile-loaderç±»ä¼¼ï¼Œä½†èƒ½åœ¨æ–‡ä»¶å¾ˆå°çš„æƒ…å†µä¸‹ä»¥ base64 çš„æ–¹å¼æŠŠæ–‡ä»¶å†…å®¹æ³¨å…¥åˆ°ä»£ç ä¸­å»ï¼›
- [source-map-loader](https://github.com/webpack-contrib/source-map-loader)ï¼šåŠ è½½é¢å¤–çš„ Source Map æ–‡ä»¶ï¼Œä»¥æ–¹ä¾¿æ–­ç‚¹è°ƒè¯•ï¼›
- [svg-inline-loader](https://github.com/webpack-contrib/svg-inline-loader)ï¼šæŠŠå‹ç¼©åçš„ SVG å†…å®¹æ³¨å…¥åˆ°ä»£ç ä¸­ï¼›
- [node-loader](https://github.com/webpack-contrib/node-loader)ï¼šåŠ è½½ Node.js åŸç”Ÿæ¨¡å— .node æ–‡ä»¶ï¼›
- [image-loader](https://github.com/tcoopman/image-webpack-loader)ï¼šåŠ è½½å¹¶ä¸”å‹ç¼©å›¾ç‰‡æ–‡ä»¶ï¼›
- [json-loader](https://github.com/webpack-contrib/json-loader)ï¼šåŠ è½½ JSON æ–‡ä»¶ï¼›
- [yaml-loader](https://github.com/eemeli/yaml-loader)ï¼šåŠ è½½ YAML æ–‡ä»¶ï¼›

### ç¼–è¯‘æ¨¡æ¿

- [pug-loader](https://github.com/pugjs/pug-loader)ï¼šæŠŠ Pug æ¨¡ç‰ˆè½¬æ¢æˆ JavaScript å‡½æ•°è¿”å›ï¼›
- [handlebars-loader](https://github.com/pcardune/handlebars-loader)ï¼šæŠŠ Handlebars æ¨¡ç‰ˆç¼–è¯‘æˆå‡½æ•°è¿”å›ï¼›
- [ejs-loader](https://github.com/difelice/ejs-loader)æŠŠ EJS æ¨¡ç‰ˆç¼–è¯‘æˆå‡½æ•°è¿”å›ï¼›
- [haml-loader](https://github.com/AlexanderPavlenko/haml-loader)ï¼šæŠŠ HAML ä»£ç è½¬æ¢æˆ HTMLï¼›
- [markdown-loader](https://github.com/peerigon/markdown-loader)ï¼šæŠŠ Markdown æ–‡ä»¶è½¬æ¢æˆ HTMLï¼›

### è½¬æ¢è„šæœ¬è¯­è¨€

- [babel-loader](https://github.com/babel/babel-loader)ï¼šæŠŠ ES6 è½¬æ¢æˆ ES5ï¼›ğŸš©
- [ts-loader](https://github.com/TypeStrong/ts-loader)ï¼šæŠŠ TypeScript è½¬æ¢æˆ JavaScriptï¼›
- [awesome-typescript-loader](https://github.com/s-panferov/awesome-typescript-loader)ï¼šæŠŠ TypeScript è½¬æ¢æˆ JavaScriptï¼Œæ€§èƒ½è¦æ¯” ts-loader å¥½ï¼›ğŸš©
- [coffee-loader](https://github.com/webpack-contrib/coffee-loader)ï¼šæŠŠ CoffeeScript è½¬æ¢æˆ JavaScriptï¼›

### è½¬æ¢æ ·å¼æ–‡ä»¶

- [css-loader](https://github.com/webpack-contrib/css-loader)ï¼šåŠ è½½ CSSï¼Œæ”¯æŒæ¨¡å—åŒ–ã€å‹ç¼©ã€æ–‡ä»¶å¯¼å…¥ç­‰ç‰¹æ€§ï¼›ğŸš©
- [style-loader](https://github.com/webpack-contrib/style-loader)ï¼šæŠŠ CSS ä»£ç æ³¨å…¥åˆ° JavaScript ä¸­ï¼Œé€šè¿‡ DOM æ“ä½œå»åŠ è½½ CSSï¼›
- [sass-loader](https://github.com/webpack-contrib/sass-loader)ï¼šæŠŠ SCSS/SASS ä»£ç è½¬æ¢æˆ CSSï¼›ğŸš©
- [postcss-loader](https://github.com/webpack-contrib/postcss-loader)ï¼šæ‰©å±• CSS è¯­æ³•ï¼Œä½¿ç”¨ä¸‹ä¸€ä»£ CSSï¼›
- [less-loader](https://github.com/webpack-contrib/less-loader)ï¼šæŠŠ Less ä»£ç è½¬æ¢æˆ CSS ä»£ç ï¼›
- [stylus-loader](https://github.com/webpack-contrib/stylus-loader)ï¼šæŠŠ Stylus ä»£ç è½¬æ¢æˆ CSS ä»£ç ï¼›

### æ£€æŸ¥ä»£ç 

- [eslint-loader](https://github.com/webpack-contrib/eslint-loader)ï¼šé€šè¿‡ ESLint æ£€æŸ¥ JavaScript ä»£ç ï¼›ğŸš©
- [tslint-loader](https://github.com/wbuchwalter/tslint-loader)ï¼šé€šè¿‡ TSLint æ£€æŸ¥ TypeScript ä»£ç ï¼›
- [mocha-loader](https://github.com/webpack-contrib/mocha-loader)ï¼šåŠ è½½ Mocha æµ‹è¯•ç”¨ä¾‹ä»£ç ï¼›
- [coverjs-loader](https://github.com/webpack-contrib/coverjs-loader)ï¼šè®¡ç®—æµ‹è¯•è¦†ç›–ç‡ï¼›ğŸš©

### å…¶ä»–

- [vue-loader](https://github.com/vuejs/vue-loader)ï¼šåŠ è½½ Vue.js å•æ–‡ä»¶ç»„ä»¶ï¼›
- [i18n-loader](https://github.com/webpack-contrib/i18n-loader)ï¼šåŠ è½½å¤šè¯­è¨€ç‰ˆæœ¬ï¼Œæ”¯æŒå›½é™…åŒ–ï¼›
- [ignore-loader](https://github.com/cherrry/ignore-loader)ï¼šå¿½ç•¥æ‰éƒ¨åˆ†æ–‡ä»¶ï¼›
- [ui-component-loader](https://github.com/gwuhaolin/ui-component-loader)ï¼šæŒ‰éœ€åŠ è½½ UI ç»„ä»¶åº“ï¼Œä¾‹å¦‚åœ¨ä½¿ç”¨ antd UI ç»„ä»¶åº“æ—¶ï¼Œä¸ä¼šå› ä¸ºåªç”¨åˆ°äº† Button ç»„ä»¶è€Œæ‰“åŒ…è¿›æ‰€æœ‰çš„ç»„ä»¶ï¼›ğŸš©

## å¸¸è§ Pluginsï¼š

### ç”¨äºä¿®æ”¹è¡Œä¸º

- [define-plugin](https://webpack.js.org/plugins/define-plugin/)ï¼šå®šä¹‰ç¯å¢ƒå˜é‡ï¼›
- [context-replacement-plugin](https://webpack.js.org/plugins/context-replacement-plugin/)ï¼šä¿®æ”¹ require è¯­å¥åœ¨å¯»æ‰¾æ–‡ä»¶æ—¶çš„é»˜è®¤è¡Œä¸ºï¼›
- [ignore-plugin](https://webpack.js.org/plugins/ignore-plugin/)ï¼šç”¨äºå¿½ç•¥éƒ¨åˆ†æ–‡ä»¶ï¼›

### ç”¨äºä¼˜åŒ–

- [commons-chunk-plugin](https://webpack.js.org/plugins/commons-chunk-plugin/)ï¼šæå–å…¬å…±ä»£ç ï¼›
- [extract-text-webpack-plugin](https://github.com/webpack-contrib/extract-text-webpack-plugin)ï¼šæå–jsä¸­çš„cssä»£ç åˆ°å•ç‹¬çš„æ–‡ä»¶ä¸­ï¼›
- [uglifyjs-webpack-plugin](https://github.com/webpack-contrib/uglifyjs-webpack-plugin)ï¼šé€šè¿‡ UglifyES å‹ç¼©ES6çš„ä»£ç ï¼›ğŸš©
- [webpack-parallel-uglify-plugin](https://github.com/gdborton/webpack-parallel-uglify-plugin)ï¼šå¤šè¿›ç¨‹æ‰§è¡Œ UglifyJSçš„ä»£ç å‹ç¼©ï¼Œæå‡å»ºæ„é€Ÿåº¦ï¼›ğŸš©
- [imagemin-webpack-plugin](https://www.npmjs.com/package/imagemin-webpack-plugin)ï¼šå‹ç¼©å›¾ç‰‡æ–‡ä»¶ï¼›
- [webpack-spritesmith](https://www.npmjs.com/package/webpack-spritesmith)ï¼šç”¨æ’ä»¶åˆ¶ä½œé›ªç¢§å›¾ï¼›
- [ModuleConcatenationPlugin](https://webpack.js.org/plugins/module-concatenation-plugin/)ï¼šå¼€å¯ Webpack Scope Hoisting åŠŸèƒ½ï¼›ğŸš©
- [dll-plugin](https://webpack.js.org/plugins/dll-plugin/)ï¼šå€Ÿé‰´ **DDL** çš„æ€æƒ³å¤§å¹…åº¦æå‡æ„å»ºé€Ÿåº¦ï¼›ğŸš©
- [hot-module-replacement-plugin](https://webpack.js.org/plugins/hot-module-replacement-plugin/)ï¼šå¼€å¯æ¨¡å—çƒ­æ›¿æ¢åŠŸèƒ½ï¼›ğŸš©

### å…¶ä»–

- [serviceworker-webpack-plugin](https://github.com/oliviertassinari/serviceworker-webpack-plugin)ï¼šç»™ç½‘é¡µåº”ç”¨å¢åŠ ç¦»çº¿ç¼“å­˜åŠŸèƒ½ï¼›
- [stylelint-webpack-plugin](https://github.com/webpack-contrib/stylelint-webpack-plugin)ï¼šé›†æˆ stylelint åˆ°é¡¹ç›®ï¼›
- [i18n-webpack-plugin](https://github.com/webpack-contrib/i18n-webpack-plugin)ï¼šç»™ä½ çš„ç½‘é¡µæ”¯æŒå›½é™…åŒ–ï¼›
- [provide-plugin](https://webpack.js.org/plugins/provide-plugin/)ï¼šä»ç¯å¢ƒä¸­æä¾›çš„å…¨å±€å˜é‡ä¸­åŠ è½½æ¨¡å—ï¼Œè€Œä¸ç”¨å¯¼å…¥å¯¹åº”çš„æ–‡ä»¶ï¼›
- [web-webpack-plugin](https://github.com/gwuhaolin/web-webpack-plugin)ï¼šæ–¹ä¾¿çš„ä¸ºå•é¡µåº”ç”¨è¾“å‡º HTMLï¼Œæ¯” html-webpack-plugin å¥½ç”¨ï¼›ğŸš©

## ğŸš© webpack ä¼˜åŒ–ï¼ˆinterviewï¼‰

### ä¸€ã€ç¼©å°æ–‡ä»¶æœç´¢èŒƒå›´

:::info

webpackå¯åŠ¨åä»é…ç½®çš„ Entry å‡ºå‘ï¼Œè§£æå‡ºæ–‡ä»¶ä¸­çš„å¯¼å…¥è¯­å¥ï¼Œå†é€’å½’çš„è§£æã€‚åœ¨é‡åˆ°å¯¼å…¥è¯­å¥æ—¶ï¼Œwebpackä¼šåšä¸¤ä»¶äº‹ï¼š

1. æ ¹æ®å¯¼å…¥è¯­å¥æ‰¾åˆ°å¯¹åº”çš„è¦å¯¼å…¥çš„æ–‡ä»¶ï¼›
2. æ ¹æ®æ‰¾åˆ°çš„å¯¼å…¥æ–‡ä»¶çš„åç¼€ï¼Œä½¿ç”¨é…ç½®ä¸­çš„ loader å»å¤„ç†æ–‡ä»¶ï¼Œå¦‚ ES6 å¼€å‘çš„jsæ–‡ä»¶è¦ç”¨babel-loader;

å½“é¡¹ç›®å˜å¤§ï¼Œæ–‡ä»¶é‡å¾ˆå¤šï¼Œåšä»¥ä¸Šä¸¤ä»¶äº‹å¾ˆå½±å“æ„å»ºé€Ÿåº¦ï¼Œæ‰€ä»¥éœ€äººä¸ºç¼©å°æ–‡ä»¶æœç´¢èŒƒå›´ã€‚

:::
- ä¼˜åŒ– **module.rules ä¸­çš„ loader** é…ç½®ï¼Œé€šè¿‡ testã€includeã€exclude å‘½ä¸­ loader è¦åº”ç”¨è§„åˆ™çš„æ–‡ä»¶:
  ```js
  module.exports = {
    module: {
      rules: [{
        // å¦‚æœé¡¹ç›®æºç ä¸­åªæœ‰ js æ–‡ä»¶å°±ä¸è¦å†™æˆ /\.jsx?$/ï¼Œæå‡æ­£åˆ™è¡¨è¾¾å¼æ€§èƒ½
        test: /\.js$/,
        // babel-loader æ”¯æŒç¼“å­˜è½¬æ¢å‡ºçš„ç»“æœï¼Œé€šè¿‡ cacheDirectory é€‰é¡¹å¼€å¯
        use: ['babel-loader?cacheDirectory'],
        // åªå¯¹é¡¹ç›®æ ¹ç›®å½•ä¸‹çš„ src ç›®å½•ä¸­çš„æ–‡ä»¶é‡‡ç”¨ babel-loader
        include: path.resolve(__dirname, 'src'),
      }]
  }}
  ```
- ä¼˜åŒ– **resolve.modules** é…ç½®

  resolve.modules çš„é»˜è®¤å€¼æ˜¯ ['node_modules']ï¼Œå«ä¹‰æ˜¯å…ˆå»å½“å‰ç›®å½•ä¸‹çš„ ./node_modules ç›®å½•ä¸‹å»æ‰¾æƒ³æ‰¾çš„æ¨¡å—ï¼Œå¦‚æœæ²¡æ‰¾åˆ°å°±å»ä¸Šä¸€çº§ç›®å½• ../node_modules ä¸­æ‰¾ï¼Œå†æ²¡æœ‰å°±å» ../../node_modules ä¸­æ‰¾ï¼Œä»¥æ­¤ç±»æ¨ï¼Œè¿™å’Œ Node.js çš„æ¨¡å—å¯»æ‰¾æœºåˆ¶å¾ˆç›¸ä¼¼ã€‚

  å½“å®‰è£…çš„ç¬¬ä¸‰æ–¹æ¨¡å—éƒ½æ”¾åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹çš„ ./node_modules ç›®å½•ä¸‹æ—¶ï¼Œæ²¡æœ‰å¿…è¦æŒ‰ç…§é»˜è®¤çš„æ–¹å¼å»ä¸€å±‚å±‚çš„å¯»æ‰¾ï¼Œå¯ä»¥æŒ‡æ˜å­˜æ”¾ç¬¬ä¸‰æ–¹æ¨¡å—çš„ç»å¯¹è·¯å¾„ï¼Œä»¥å‡å°‘å¯»æ‰¾ï¼Œé…ç½®å¦‚ä¸‹ï¼š

  ```js
  module.exports = {
    resolve: {
      // ä½¿ç”¨ç»å¯¹è·¯å¾„æŒ‡æ˜ç¬¬ä¸‰æ–¹æ¨¡å—å­˜æ”¾çš„ä½ç½®ï¼Œä»¥å‡å°‘æœç´¢æ­¥éª¤
      // å…¶ä¸­ __dirname è¡¨ç¤ºå½“å‰å·¥ä½œç›®å½•ï¼Œä¹Ÿå°±æ˜¯é¡¹ç›®æ ¹ç›®å½•
      modules: [path.resolve(__dirname, 'node_modules')]
    }
  };
  ```
- ä¼˜åŒ– **resolve.mainFields** é…ç½®

  resolve.mainFields ç”¨äºé…ç½®ç¬¬ä¸‰æ–¹æ¨¡å—ä½¿ç”¨å“ªä¸ªå…¥å£æ–‡ä»¶ã€‚åœ¨ä½ æ˜ç¡®ç¬¬ä¸‰æ–¹æ¨¡å—çš„å…¥å£æ–‡ä»¶æè¿°å­—æ®µæ—¶ï¼Œä½ å¯ä»¥æŠŠå®ƒè®¾ç½®çš„å°½é‡å°‘ã€‚ ç”±äºå¤§å¤šæ•°ç¬¬ä¸‰æ–¹æ¨¡å—éƒ½é‡‡ç”¨ main å­—æ®µå»æè¿°å…¥å£æ–‡ä»¶çš„ä½ç½®ï¼Œå¯ä»¥è¿™æ ·é…ç½® Webpackï¼š

  ```js
  module.exports = {
    resolve: {
      // åªé‡‡ç”¨ main å­—æ®µä½œä¸ºå…¥å£æ–‡ä»¶æè¿°å­—æ®µï¼Œä»¥å‡å°‘æœç´¢æ­¥éª¤
      mainFields: ['main'],
    },
  };
  ```
- ä¼˜åŒ– **resolve.alias** é…ç½®
  ```js
  // é»˜è®¤æƒ…å†µä¸‹ Webpack ä¼šä»å…¥å£æ–‡ä»¶ ./node_modules/react/react.js 
  // å¼€å§‹é€’å½’çš„è§£æå’Œå¤„ç†ä¾èµ–çš„å‡ åä¸ªæ–‡ä»¶ï¼Œè¿™ä¼šæ—¶ä¸€ä¸ªè€—æ—¶çš„æ“ä½œã€‚
  module.exports = {
    resolve: {
      // ä½¿ç”¨ alias æŠŠå¯¼å…¥ react çš„è¯­å¥æ¢æˆç›´æ¥ä½¿ç”¨å•ç‹¬å®Œæ•´çš„ react.min.js æ–‡ä»¶ï¼Œ
      // å‡å°‘è€—æ—¶çš„é€’å½’è§£ææ“ä½œ
      alias: {
        'react': path.resolve(__dirname, './node_modules/react/dist/react.min.js'), // react15
        // 'react': path.resolve(__dirname, './node_modules/react/umd/react.production.min.js'), // react16
      }
  }}
  ```
- ä¼˜åŒ– **resolve.extensions** é…ç½®,å°½å¯èƒ½çš„å‡å°‘åç¼€å°è¯•çš„å¯èƒ½æ€§
- ä¼˜åŒ– **module.noParse** é…ç½®ï¼Œè§æœ¬æ–‡ğŸŒ¸

### äºŒã€ä½¿ç”¨ [DLLPlugin](https://webpack.js.org/plugins/dll-plugin/)

- ä»€ä¹ˆæ˜¯DLLï¼Ÿ

  webpackä¸­çš„ dill-plugin çš„ä½¿ç”¨æ˜¯å¼•å…¥äº†å¾®è½¯çš„åŠ¨æ€é“¾æ¥åº“ï¼ˆDLLï¼‰æ€æƒ³ã€‚

  DLL,ç”¨è¿‡ Windows ç³»ç»Ÿçš„äººåº”è¯¥ä¼šç»å¸¸çœ‹åˆ°ä»¥ .dll ä¸ºåç¼€çš„æ–‡ä»¶ï¼Œè¿™äº›æ–‡ä»¶ç§°ä¸ºåŠ¨æ€é“¾æ¥åº“ï¼Œåœ¨ä¸€ä¸ªåŠ¨æ€é“¾æ¥åº“ä¸­å¯ä»¥åŒ…å«ç»™å…¶ä»–æ¨¡å—è°ƒç”¨çš„å‡½æ•°å’Œæ•°æ®ã€‚

  ä¸ºwebé¡¹ç›®åŠ å…¥ DLL æ€æƒ³åï¼Œæé«˜äº†æ„å»ºé€Ÿåº¦ã€‚å› ä¸º<u>åŒ…å«å¤§é‡å¤ç”¨æ¨¡å—çš„åŠ¨æ€é“¾æ¥åº“åªéœ€ç¼–è¯‘ä¸€æ¬¡</u>ï¼Œåœ¨ä¹‹åçš„æ„å»ºè¿‡ç¨‹ä¸­è¢«åŠ¨æ€é“¾æ¥åº“åŒ…å«çš„æ¨¡å—å°†ä¸ä¼šå†é‡æ–°ç¼–è¯‘ï¼Œè€Œæ˜¯ç›´æ¥ä½¿ç”¨åŠ¨æ€é“¾æ¥åº“ä¸­çš„ä»£ç ã€‚åŠ¨æ€é“¾æ¥åº“å¤§å¤šåŒ…å«çš„æ˜¯å¸¸ç”¨çš„ç¬¬ä¸‰æ–¹ä»£ç ï¼Œå¦‚reactã€react-dom,åªè¦ä¸å‡çº§å°±ä¸ä¼šé‡æ–°ç¼–è¯‘ã€‚

- Webpack å·²ç»å†…ç½®äº†å¯¹åŠ¨æ€é“¾æ¥åº“çš„æ”¯æŒï¼Œéœ€è¦é€šè¿‡2ä¸ªå†…ç½®çš„æ’ä»¶æ¥å…¥ï¼š
  1. `DllPlugin`ï¼šç”¨äºæ‰“åŒ…å‡ºä¸€ä¸ªä¸ªå•ç‹¬çš„åŠ¨æ€é“¾æ¥åº“æ–‡ä»¶ï¼›
  2. `DllReferencePlugin`ï¼šç”¨äºåœ¨ä¸»è¦é…ç½®æ–‡ä»¶ä¸­å»å¼•å…¥ DllPlugin æ’ä»¶æ‰“åŒ…å¥½çš„åŠ¨æ€é“¾æ¥åº“æ–‡ä»¶ã€‚

  [ä½¿ç”¨æ•™ç¨‹](https://webpack.docschina.org/plugins/dll-plugin/)

### ä¸‰ã€ä½¿ç”¨ ParallelUglifyPlugin

- ä½¿ç”¨èƒŒæ™¯

  webpackå†…ç½®äº†[UglifyJS](https://github.com/mishoo/UglifyJS)ç”¨äºå‹ç¼©ä»£ç ã€‚

  UglifyJSæ˜¯ä¸€ä¸ªä»£ç å‹ç¼©åº“ï¼Œå®ƒåœ¨æ„å»ºç”¨äºå¼€å‘ç¯å¢ƒçš„ä»£ç å®Œæˆé€Ÿåº¦å¿«ï¼Œä½†åœ¨ç”Ÿäº§ç¯å¢ƒæ„å»ºæ—¶ä¼šä¸€ç›´å¡åœ¨ä¸€ä¸ªæ—¶é—´ç‚¹æ²¡æœ‰ååº”ï¼Œå› ä¸ºä¸€ç›´åœ¨ä»£ç å‹ç¼©ä¸­â€¦â€¦

  ç”±äºå‹ç¼©JSä»£ç éœ€è¦å…ˆæŠŠä»£ç è§£ææˆ Object æŠ½è±¡è¡¨ç¤ºçš„ AST è¯­æ³•æ ‘ï¼Œå†å»åº”ç”¨å„ç§è§„åˆ™åˆ†æå’Œå¤„ç† AST ï¼Œå¯¼è‡´è¿™ä¸ªè¿‡ç¨‹è®¡ç®—é‡å·¨å¤§ï¼Œè€—æ—¶å¾ˆå¤šã€‚

- [parallelUglifyPlugin](https://github.com/gdborton/webpack-parallel-uglify-plugin)åº”ç”¨äº†å¤šè¿›ç¨‹å¹¶è¡Œå¤„ç†çš„æ€æƒ³ã€‚ UglifyJSæ˜¯ä¸€ä¸ªä¸ªæŒ¨ç€å‹ç¼©å†è¾“å‡ºï¼Œ`parallelUglifyPlugin`åˆ™ä¼šå¼€å¯å¤šä¸ªå­è¿›ç¨‹ï¼ŒæŠŠå¯¹å¤šä¸ªæ–‡ä»¶çš„å‹ç¼©å·¥ä½œåˆ†é…ç»™å¤šä¸ªå­è¿›ç¨‹å»å®Œæˆï¼Œæ¯ä¸ªå­è¿›ç¨‹å…¶å®è¿˜æ˜¯é€šè¿‡ `UglifyJS` å»å‹ç¼©ä»£ç ï¼Œä½†æ˜¯å˜æˆäº†å¹¶è¡Œæ‰§è¡Œã€‚ æ‰€ä»¥ `ParallelUglifyPlugin` èƒ½æ›´å¿«çš„å®Œæˆå¯¹å¤šä¸ªæ–‡ä»¶çš„å‹ç¼©å·¥ä½œã€‚
  ```js
  const path = require('path');
  const DefinePlugin = require('webpack/lib/DefinePlugin');
  const ParallelUglifyPlugin = require('webpack-parallel-uglify-plugin');

  module.exports = {
    plugins: [
      // ä½¿ç”¨ ParallelUglifyPlugin å¹¶è¡Œå‹ç¼©è¾“å‡ºçš„ JS ä»£ç 
      new ParallelUglifyPlugin({
        // ä¼ é€’ç»™ UglifyJS çš„å‚æ•°
        uglifyJS: {
          output: {
            // æœ€ç´§å‡‘çš„è¾“å‡º
            beautify: false,
            // åˆ é™¤æ‰€æœ‰çš„æ³¨é‡Š
            comments: false,
          },
          compress: {
            // åœ¨UglifyJsåˆ é™¤æ²¡æœ‰ç”¨åˆ°çš„ä»£ç æ—¶ä¸è¾“å‡ºè­¦å‘Š
            warnings: false,
            // åˆ é™¤æ‰€æœ‰çš„ `console` è¯­å¥ï¼Œå¯ä»¥å…¼å®¹ieæµè§ˆå™¨
            drop_console: true,
            // å†…åµŒå®šä¹‰äº†ä½†æ˜¯åªç”¨åˆ°ä¸€æ¬¡çš„å˜é‡
            collapse_vars: true,
            // æå–å‡ºå‡ºç°å¤šæ¬¡ä½†æ˜¯æ²¡æœ‰å®šä¹‰æˆå˜é‡å»å¼•ç”¨çš„é™æ€å€¼
            reduce_vars: true,
          }
  }})]}
  ```

### å››ã€ä½¿ç”¨è‡ªåŠ¨åˆ·æ–°

å¼€å‘æ—¶`ä¿®æ”¹æºç `åæƒ³çœ‹åˆ°è¿è¡Œåçš„æ•ˆæœï¼Œéœ€é‡æ–°ç¼–è¯‘å†è¿è¡Œã€‚è¿™ä¸ªè¿‡ç¨‹å¯ä»¥å€ŸåŠ©è‡ªåŠ¨åŒ–çš„æ‰‹æ®µï¼Œåœ¨ç›‘å¬åˆ°æºç æ–‡ä»¶å‘ç”Ÿå˜åŒ–æ—¶ï¼Œè‡ªåŠ¨é‡æ–°æ„å»ºå‡ºå¯è¿è¡Œçš„ä»£ç åå†æ§åˆ¶æµè§ˆå™¨åˆ·æ–°ã€‚

- æ–‡ä»¶ç›‘å¬ï¼Œwebapackæé«˜çš„ä¸¤å¤§æ¨¡å—[webpack](https://www.npmjs.com/package/webpack)å’Œ[webpack-dev-server](https://www.npmjs.com/package/webpack-dev-server)
  ```js
  module.export = {
    // åªæœ‰åœ¨å¼€å¯ç›‘å¬æ¨¡å¼æ—¶ï¼ŒwatchOptions æ‰æœ‰æ„ä¹‰
    // é»˜è®¤ä¸º falseï¼Œä¹Ÿå°±æ˜¯ä¸å¼€å¯
    watch: true,
    // ç›‘å¬æ¨¡å¼è¿è¡Œæ—¶çš„å‚æ•°
    // åœ¨å¼€å¯ç›‘å¬æ¨¡å¼æ—¶ï¼Œæ‰æœ‰æ„ä¹‰
    watchOptions: {
      // ä¸ç›‘å¬çš„æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹ï¼Œæ”¯æŒæ­£åˆ™åŒ¹é…
      // é»˜è®¤ä¸ºç©º
      ignored: /node_modules/,
      // ç›‘å¬åˆ°å˜åŒ–å‘ç”Ÿåä¼šç­‰300mså†å»æ‰§è¡ŒåŠ¨ä½œï¼Œé˜²æ­¢æ–‡ä»¶æ›´æ–°å¤ªå¿«å¯¼è‡´é‡æ–°ç¼–è¯‘é¢‘ç‡å¤ªé«˜
      // é»˜è®¤ä¸º 300ms
      aggregateTimeout: 300,
      // åˆ¤æ–­æ–‡ä»¶æ˜¯å¦å‘ç”Ÿå˜åŒ–æ˜¯é€šè¿‡ä¸åœçš„å»è¯¢é—®ç³»ç»ŸæŒ‡å®šæ–‡ä»¶æœ‰æ²¡æœ‰å˜åŒ–å®ç°çš„
      // é»˜è®¤æ¯éš”1000æ¯«ç§’è¯¢é—®ä¸€æ¬¡
      poll: 1000
    }
  }
  ```
- ä¼˜åŒ–æ–‡ä»¶ç›‘å¬æ€§èƒ½ï¼šå¼€å¯ç›‘å¬æ¨¡å¼æ—¶ï¼Œé»˜è®¤æƒ…å†µä¸‹ä¼šç›‘å¬é…ç½®çš„ Entry æ–‡ä»¶å’Œæ‰€æœ‰å…¶é€’å½’ä¾èµ–çš„æ–‡ä»¶ã€‚ åœ¨è¿™äº›æ–‡ä»¶ä¸­ä¼šæœ‰å¾ˆå¤šå­˜åœ¨äº node_modules ä¸‹ï¼Œå› ä¸ºå¦‚ä»Šçš„ Web é¡¹ç›®ä¼šä¾èµ–å¤§é‡çš„ç¬¬ä¸‰æ–¹æ¨¡å—ã€‚ åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹æˆ‘ä»¬éƒ½ä¸å¯èƒ½å»ç¼–è¾‘ node_modules ä¸‹çš„æ–‡ä»¶ï¼Œè€Œæ˜¯ç¼–è¾‘è‡ªå·±å»ºç«‹çš„æºç æ–‡ä»¶ã€‚ æ‰€ä»¥ä¸€ä¸ªå¾ˆå¤§çš„ä¼˜åŒ–ç‚¹å°±æ˜¯å¿½ç•¥æ‰ node_modules ä¸‹çš„æ–‡ä»¶ï¼Œä¸å»ç›‘å¬å®ƒä»¬ã€‚
  ```js
  module.export = {
    watchOptions: { ignored: /node_modules/}// ä¸ç›‘å¬çš„ node_modules ç›®å½•ä¸‹çš„æ–‡ä»¶
  }
  ```
### äº”ã€å¼€å¯çƒ­æ¨¡å—æ›¿æ¢

è¦åšåˆ°å®æ—¶é¢„è§ˆï¼Œé™¤äº†åˆ·æ–°æ•´ä¸ªç½‘é¡µå¤–ï¼ŒDevServerè¿˜æ”¯æŒæ¨¡å—çƒ­æ›¿æ¢(`Hot Module Replacement`)çš„æŠ€æœ¯ã€‚å®ƒèƒ½**åœ¨ä¸åˆ·æ–°ç½‘é¡µçš„æƒ…å†µä¸‹åšåˆ°è¶…çµæ•çš„å®æ—¶æµè§ˆ**ã€‚

åŸç†æ˜¯å½“ä¸€ä¸ªæºç å‘ç”Ÿæ”¹å˜æ—¶ï¼Œåªé‡æ–°ç¼–è¯‘å‘ç”Ÿå˜åŒ–çš„æ¨¡å—ï¼Œå†ç”¨æ–°è¾“å‡ºçš„æ¨¡å—æ›¿æ¢æ‰æµè§ˆå™¨ä¸­å¯¹åº”çš„è€æ¨¡å—ã€‚

- åŸç†ï¼šå’Œè‡ªåŠ¨åˆ·æ–°ç±»ä¼¼ï¼Œéƒ½éœ€è¦å¾€å¼€å‘çš„ç½‘é¡µä¸­æ³¨å…¥ä¸€ä¸ªä»£ç†å®¢æˆ·ç«¯ç”¨äºè¿æ¥ DevServer å’Œç½‘é¡µï¼Œä¸åŒåœ¨äºçƒ­æ¨¡å—æ›¿æ¢çš„ç‹¬ç‰¹æ¨¡å—æ›¿æ¢æœºåˆ¶ã€‚

- ä½¿ç”¨ï¼š**ä¸“ç”¨äºå¼€å‘ç¯å¢ƒ**ï¼Œç”Ÿäº§ä¸å¯ç”¨ã€‚
  ```js
  // æ–¹æ³•ä¸€ï¼šåœ¨å¯åŠ¨æ—¶å¸¦ä¸Šå‚æ•° `--hot`ï¼Œå®Œæ•´å‘½ä»¤æ˜¯ `webpack-dev-server --hot`ã€‚
  // æ–¹æ³•äºŒï¼šPluginå¦‚ä¸‹
  const HotModuleReplacementPlugin = require('webpack/liHotModuleReplacementPlugin');
  module.exports = {
    entry:{
      // ä¸ºæ¯ä¸ªå…¥å£éƒ½æ³¨å…¥ä»£ç†å®¢æˆ·ç«¯
      main:['webpack-dev-server/client?http://localhost:8080/', 
      'webpack/hot/dev-server','./src/main.js'],
    },
    plugins: [
      // è¯¥æ’ä»¶çš„ä½œç”¨å°±æ˜¯å®ç°æ¨¡å—çƒ­æ›¿æ¢ï¼Œ
      //å®é™…ä¸Šå½“å¯åŠ¨æ—¶å¸¦ä¸Š `--hot` å‚æ•°ï¼Œä¼šæ³¨å…¥è¯¥æ’ä»¶ï¼Œç”Ÿæˆ .hot-update.json æ–‡ä»¶ã€‚
      new HotModuleReplacementPlugin(),
    ],
    devServer:{
      // å‘Šè¯‰ DevServer è¦å¼€å¯æ¨¡å—çƒ­æ›¿æ¢æ¨¡å¼
      hot: true,      
    }  
  };
  ```
- ä¼˜åŒ–çƒ­æ¨¡å—æ›¿æ¢ï¼š
  ![](https://cetacea-1304984885.cos.ap-shanghai.myqcloud.com/pieces/Snipaste_2024-04-25_17-25-57.jpg)

### å…­ã€åŒºåˆ†ç¯å¢ƒ

- ä¸ºäº†å°½å¯èƒ½çš„å¤ç”¨ä»£ç ï¼Œåœ¨æ„å»ºçš„è¿‡ç¨‹ä¸­éœ€è¦æ ¹æ®ç›®æ ‡ä»£ç è¦è¿è¡Œçš„ç¯å¢ƒè€Œè¾“å‡ºä¸åŒçš„ä»£ç ï¼Œæˆ‘ä»¬éœ€è¦ä¸€å¥—æœºåˆ¶åœ¨æºç ä¸­å»åŒºåˆ†ç¯å¢ƒã€‚ 

- åŸç†æ˜¯å€ŸåŠ©äºç¯å¢ƒå˜é‡çš„å€¼å»åˆ¤æ–­æ‰§è¡Œå“ªä¸ªåˆ†æ”¯ã€‚[process](https://nodejs.org/api/process.html)è¯­å¥å‡ºç°ï¼Œwebpackè‡ªåŠ¨æ‰“åŒ…è¿›processæ¨¡å—ä»¥æ”¯æŒNode.jsçš„è¿è¡Œç¯å¢ƒã€‚æºç å¦‚ä¸‹ï¼š

  ```js
  if (process.env.NODE_ENV === 'production') {
    console.log('ä½ æ­£åœ¨çº¿ä¸Šç¯å¢ƒ');
  } else {
    console.log('ä½ æ­£åœ¨ä½¿ç”¨å¼€å‘ç¯å¢ƒ');
  }
  ```
- ç¬¬ä¸‰æ–¹åº“ä¸­çš„ç¯å¢ƒåŒºåˆ†
  ```js
  if (process.env.NODE_ENV !== 'production') {
    warning(false, '%s(...): Can only update a mounted or mounting component.... ')
  }
  ```

### ä¸ƒã€å‹ç¼©ä»£ç 

å‹ç¼©ä»£ç å¯ä»¥æå‡ç½‘é¡µåŠ è½½é€Ÿåº¦ï¼Œå‡å°‘ç½‘ç»œä¼ è¾“æµé‡ï¼Œæå‡ä»£ç å®‰å…¨ã€‚
 
- **å‹ç¼© Javascript**

  ç›®å‰æˆç†Ÿçš„å‹ç¼©å·¥å…·æ˜¯`UglifyJS`ï¼Œå®ƒä¼šåˆ†æJSè¯­æ³•æ ‘ï¼Œç†è§£ä»£ç å«ä¹‰ï¼Œå»æ‰æ— æ•ˆä»£ç ï¼Œç¼©çŸ­å˜é‡åç­‰ä¼˜åŒ–ã€‚

  webpackä¸­æ¥å…¥`UglifyJS`éœ€è¦ä¸¤ä¸ªæˆç†Ÿçš„æ’ä»¶ï¼š

  1ï¸âƒ£ UglifyJsPluginï¼šé€šè¿‡å°è£… UglifyJS å®ç°å‹ç¼©ï¼›å½“å‰é‡‡ç”¨çš„æ˜¯ [UglifyJS2](https://github.com/mishoo/UglifyJS)è€Œä¸æ˜¯è€çš„ UglifyJS1;é™¤æ­¤ä¹‹å¤– Webpack è¿˜æä¾›äº†ä¸€ä¸ªæ›´ç®€ä¾¿çš„æ–¹æ³•æ¥æ¥å…¥ UglifyJSPluginï¼Œç›´æ¥åœ¨å¯åŠ¨ Webpack æ—¶å¸¦ä¸Š --optimize-minimize å‚æ•°ï¼Œå³ `webpack --optimize-minimize`ï¼Œ è¿™æ · Webpack ä¼šè‡ªåŠ¨ä¸ºä½ æ³¨å…¥ä¸€ä¸ªå¸¦æœ‰é»˜è®¤é…ç½®çš„ UglifyJSPluginã€‚

  2ï¸âƒ£ ParallelUglifyPluginï¼šå¤šè¿›ç¨‹å¹¶è¡Œå¤„ç†å‹ç¼©ã€‚

  ```js
  const UglifyJSPlugin = require('webpack/lib/optimize/UglifyJsPlugin');
  module.exports = {
    plugins: [
      // å‹ç¼©è¾“å‡ºçš„ JS ä»£ç 
      new UglifyJSPlugin({
        compress: {
          // åœ¨UglifyJsåˆ é™¤æ²¡æœ‰ç”¨åˆ°çš„ä»£ç æ—¶ä¸è¾“å‡ºè­¦å‘Š
          warnings: false,
          // åˆ é™¤æ‰€æœ‰çš„ `console` è¯­å¥ï¼Œå¯ä»¥å…¼å®¹ieæµè§ˆå™¨
          drop_console: true,
          // å†…åµŒå®šä¹‰äº†ä½†æ˜¯åªç”¨åˆ°ä¸€æ¬¡çš„å˜é‡
          collapse_vars: true,
          // æå–å‡ºå‡ºç°å¤šæ¬¡ä½†æ˜¯æ²¡æœ‰å®šä¹‰æˆå˜é‡å»å¼•ç”¨çš„é™æ€å€¼
          reduce_vars: true,
        },
        output: {
          // æœ€ç´§å‡‘çš„è¾“å‡º
          beautify: false,
          // åˆ é™¤æ‰€æœ‰çš„æ³¨é‡Š
          comments: false,
        }
  })]}
  ```

- **å‹ç¼© ES6**

  ç›®å‰å¤§éƒ¨åˆ† JavaScript å¼•æ“è¿˜ä¸å®Œå…¨æ”¯æŒ ES6 ä¸­çš„æ–°ç‰¹æ€§ï¼Œä½†åœ¨ä¸€äº›ç‰¹å®šçš„è¿è¡Œç¯å¢ƒä¸‹å·²ç»å¯ä»¥ç›´æ¥æ‰§è¡Œ ES6 ä»£ç äº†ï¼Œä¾‹å¦‚æœ€æ–°ç‰ˆçš„ Chromeã€ReactNative çš„å¼•æ“ JavaScriptCoreã€‚

  ES6 çš„ä»£ç ç›¸æ¯”äºè½¬æ¢åçš„ ES5 ä»£ç æœ‰å¦‚ä¸‹ä¼˜ç‚¹ï¼š
  - ä¸€æ ·çš„é€»è¾‘ç”¨ ES6 å®ç°çš„ä»£ç é‡æ¯” ES5 æ›´å°‘ï¼›
  - JavaScript å¼•æ“å¯¹ ES6 ä¸­çš„è¯­æ³•åšäº†æ€§èƒ½ä¼˜åŒ–ï¼Œä¾‹å¦‚é’ˆå¯¹ const ç”³æ˜çš„å˜é‡æœ‰æ›´å¿«çš„è¯»å–é€Ÿåº¦ï¼›

  æ‰€ä»¥åœ¨**è¿è¡Œç¯å¢ƒå…è®¸çš„æƒ…å†µä¸‹**ï¼Œæˆ‘ä»¬è¦å°½å¯èƒ½çš„ä½¿ç”¨åŸç”Ÿçš„ ES6 ä»£ç å»è¿è¡Œï¼Œè€Œä¸æ˜¯è½¬æ¢åçš„ ES5 ä»£ç ã€‚

  ä¸ºäº†å‹ç¼© ES6 ä»£ç ï¼Œéœ€è¦ä½¿ç”¨ä¸“é—¨é’ˆå¯¹ ES6 ä»£ç çš„ [UglifyES](https://github.com/mishoo/UglifyJS/tree/harmony)ã€‚

  ```bash
  npm i -D uglifyjs-webpack-plugin@beta
  ```
  ```js
  const UglifyESPlugin = require('uglifyjs-webpack-plugin')
  module.exports = {
    plugins: [
      new UglifyESPlugin({
        // å¤šåµŒå¥—äº†ä¸€å±‚
        uglifyOptions: {
          compress: {
            // åœ¨UglifyJsåˆ é™¤æ²¡æœ‰ç”¨åˆ°çš„ä»£ç æ—¶ä¸è¾“å‡ºè­¦å‘Š
            warnings: false,
            // åˆ é™¤æ‰€æœ‰çš„ `console` è¯­å¥ï¼Œå¯ä»¥å…¼å®¹ieæµè§ˆå™¨
            drop_console: true,
            // å†…åµŒå®šä¹‰äº†ä½†æ˜¯åªç”¨åˆ°ä¸€æ¬¡çš„å˜é‡
            collapse_vars: true,
            // æå–å‡ºå‡ºç°å¤šæ¬¡ä½†æ˜¯æ²¡æœ‰å®šä¹‰æˆå˜é‡å»å¼•ç”¨çš„é™æ€å€¼
            reduce_vars: true,
          },
          output: {
            // æœ€ç´§å‡‘çš„è¾“å‡º
            beautify: false,
            // åˆ é™¤æ‰€æœ‰çš„æ³¨é‡Š
            comments: false,
          }
  }})]}
  ```
  åŒæ—¶ï¼Œä¸ºäº†ä¸è®©`babel-loader`è¾“å‡º ES5 çš„ä»£ç ï¼Œå»æ‰`babel-preset-env`ã€‚

- **å‹ç¼© CSS**

  æˆç†Ÿçš„CSSå‹ç¼©å·¥å…·[cssnano](https://www.cssnano.cn/),åŸºäºPostCSS.

  cssnano æ¥å…¥åˆ° Webpack ä¸­ä¹Ÿéå¸¸ç®€å•ï¼Œå› ä¸º css-loader å·²ç»å°†å…¶å†…ç½®äº†ï¼Œè¦å¼€å¯ cssnano å»å‹ç¼©ä»£ç åªéœ€è¦å¼€å¯ css-loader çš„ minimize é€‰é¡¹ã€‚
  ```js
  const path = require('path');
  const {WebPlugin} = require('web-webpack-plugin');
  const ExtractTextPlugin = require('extract-text-webpack-plugin');
  module.exports = {
    module: {
      rules: [
        {
          test: /\.css$/,// å¢åŠ å¯¹ CSS æ–‡ä»¶çš„æ”¯æŒ
          // æå–å‡º Chunk ä¸­çš„ CSS ä»£ç åˆ°å•ç‹¬çš„æ–‡ä»¶ä¸­
          use: ExtractTextPlugin.extract({
            // é€šè¿‡ minimize é€‰é¡¹å‹ç¼© CSS ä»£ç 
            use: ['css-loader?minimize']
      })}]
    },
    plugins: [
      // ç”¨ WebPlugin ç”Ÿæˆå¯¹åº”çš„ HTML æ–‡ä»¶
      new WebPlugin({
        template: './template.html', // HTML æ¨¡ç‰ˆæ–‡ä»¶æ‰€åœ¨çš„æ–‡ä»¶è·¯å¾„
        filename: 'index.html' // è¾“å‡ºçš„ HTML çš„æ–‡ä»¶åç§°
      }),
      new ExtractTextPlugin({
        filename: `[name]_[contenthash:8].css`,// ç»™è¾“å‡ºçš„ CSS æ–‡ä»¶åç§°åŠ ä¸Š Hash å€¼
  })]}
  ```

### å…«ã€CDNåŠ é€Ÿ

ç½‘ç»œé¦–æ¬¡æ‰“å¼€æ—¶é—´é•¿ï¼Œæ ¹æœ¬åŸå› åœ¨äº**ç½‘ç»œä¼ è¾“è¿‡ç¨‹è€—æ—¶å¤§**ï¼ŒCDNçš„ä½œç”¨å°±æ˜¯åŠ é€Ÿç½‘ç»œä¼ è¾“ã€‚

Content Delivery Network,å†…å®¹åˆ†å‘ç½‘ç»œã€‚é€šè¿‡æŠŠèµ„æºéƒ¨ç½²åˆ°ä¸–ç•Œå„åœ°ï¼Œç”¨æˆ·åœ¨è®¿é—®æ—¶æŒ‰ç…§å°±è¿‘åŸåˆ™ä»ç¦»ç”¨æˆ·æœ€è¿‘çš„æœåŠ¡å™¨è·å–èµ„æºï¼ŒåŠ é€Ÿèµ„æºçš„è·å–é€Ÿåº¦ã€‚

ç›®å‰å¾ˆå¤šå¤§å…¬å¸éƒ½ä¼šå»ºç«‹è‡ªå·±çš„ CDN æœåŠ¡ï¼Œå°±ç®—ä½ è‡ªå·±æ²¡æœ‰èµ„æºå»æ­å»ºä¸€å¥— CDN æœåŠ¡ï¼Œå„å¤§äº‘æœåŠ¡æä¾›å•†éƒ½æä¾›äº†æŒ‰é‡æ”¶è´¹çš„ CDN æœåŠ¡ã€‚

- **ä¸šç•Œæˆç†Ÿçš„ CDN åšæ³•**
  - é’ˆå¯¹ HTML æ–‡ä»¶ï¼Œæ”¾åˆ°è‡ªå·±çš„æœåŠ¡å™¨ä¸Šï¼Œå…³é—­è‡ªå·±æœåŠ¡å™¨çš„ç¼“å­˜ï¼Œåªæä¾› HTML æ–‡ä»¶å’Œæ•°æ®æ¥å£ï¼›
  - é’ˆå¯¹é™æ€çš„jsã€imgã€fontç­‰ï¼Œå¼€å¯CDNå’Œç¼“å­˜ï¼Œä¸Šä¼ åˆ°CDNæœåŠ¡å™¨ä¸Šï¼ŒåŒæ—¶ç»™æ¯ä¸ªæ–‡ä»¶åå¸¦ä¸Šç”±å†…å®¹ç®—å‡ºçš„hashå€¼ã€‚

- **Webpackä¸­æ¥å…¥ CDN**
  ```js
  const path = require('path');
  const ExtractTextPlugin = require('extract-text-webpack-plugin');
  const {WebPlugin} = require('web-webpack-plugin');
  module.exports = {
    // çœç•¥ entry é…ç½®...
    output: {
      // ç»™è¾“å‡ºçš„ JavaScript æ–‡ä»¶åç§°åŠ ä¸Š Hash å€¼
      filename: '[name]_[chunkhash:8].js',
      path: path.resolve(__dirname, './dist'),
      // æŒ‡å®šå­˜æ”¾ JavaScript æ–‡ä»¶çš„ CDN ç›®å½• URL
      publicPath: '//js.cdn.com/id/',
    },
    module: {
      rules: [
        {
          // å¢åŠ å¯¹ CSS æ–‡ä»¶çš„æ”¯æŒ
          test: /\.css$/,
          // æå–å‡º Chunk ä¸­çš„ CSS ä»£ç åˆ°å•ç‹¬çš„æ–‡ä»¶ä¸­
          use: ExtractTextPlugin.extract({
            // å‹ç¼© CSS ä»£ç 
            use: ['css-loader?minimize'],
            // æŒ‡å®šå­˜æ”¾ CSS ä¸­å¯¼å…¥çš„èµ„æºï¼ˆä¾‹å¦‚å›¾ç‰‡ï¼‰çš„ CDN ç›®å½• URL
            publicPath: '//img.cdn.com/id/'
          }),
        },
        {
          // å¢åŠ å¯¹ PNG æ–‡ä»¶çš„æ”¯æŒ
          test: /\.png$/,
          // ç»™è¾“å‡ºçš„ PNG æ–‡ä»¶åç§°åŠ ä¸Š Hash å€¼
          use: ['file-loader?name=[name]_[hash:8].[ext]'],
        },
        // çœç•¥å…¶å®ƒ Loader é…ç½®...
      ]
    },
    plugins: [
      // ä½¿ç”¨ WebPlugin è‡ªåŠ¨ç”Ÿæˆ HTML
      new WebPlugin({
        // HTML æ¨¡ç‰ˆæ–‡ä»¶æ‰€åœ¨çš„æ–‡ä»¶è·¯å¾„
        template: './template.html',
        // è¾“å‡ºçš„ HTML çš„æ–‡ä»¶åç§°
        filename: 'index.html',
        // æŒ‡å®šå­˜æ”¾ CSS æ–‡ä»¶çš„ CDN ç›®å½• URL
        stylePublicPath: '//css.cdn.com/id/',
      }),
      new ExtractTextPlugin({
        // ç»™è¾“å‡ºçš„ CSS æ–‡ä»¶åç§°åŠ ä¸Š Hash å€¼
        filename: `[name]_[contenthash:8].css`,
      }),
      // çœç•¥ä»£ç å‹ç¼©æ’ä»¶é…ç½®...
    ],
  };
  ```

### ä¹ã€tree shakingã€ğŸŸ¡webpack2.0å¼•å…¥ã€‘

`Tree Shaking`èƒ½å‰”é™¤jsä¸­ç”¨ä¸åˆ°çš„æ­»ä»£ç ã€‚å®ƒä¾èµ–é™æ€çš„ES6è¯­æ³•ï¼Œè‹¥ä½¿ç”¨ES5ä¼šå‡ºé”™ã€‚Tree Shaingæœ€å…ˆåœ¨ Rollupä¸­å‡ºç°ï¼Œwebpack2.0å°†å…¶å¼•å…¥ã€‚

.babelrcé…ç½®
```js
{
  "presets": [
    [
      "env",
      {
        "modules": false//å…³é—­babelæ¨¡å—çš„è½¬æ¢åŠŸèƒ½ï¼Œä¿ç•™åŸæœ¬çš„ES6è¯­æ³•
      }
    ]
]}
```
é…ç½®å¥½ Babel åï¼Œé‡æ–°è¿è¡Œ Webpackï¼Œåœ¨å¯åŠ¨ Webpack æ—¶å¸¦ä¸Š --display-used-exports å‚æ•°ï¼Œä»¥æ–¹ä¾¿è¿½è¸ª Tree Shaking çš„å·¥ä½œã€‚

:::warning
Tree Shaking æ­£å¸¸å·¥ä½œçš„å‰ææ˜¯äº¤ç»™ Webpack çš„ JavaScript ä»£ç å¿…é¡»æ˜¯é‡‡ç”¨ ES6 æ¨¡å—åŒ–è¯­æ³•çš„ï¼Œ å› ä¸º ES6 æ¨¡å—åŒ–è¯­æ³•æ˜¯é™æ€çš„ï¼ˆå¯¼å…¥å¯¼å‡ºè¯­å¥ä¸­çš„è·¯å¾„å¿…é¡»æ˜¯é™æ€çš„å­—ç¬¦ä¸²ï¼Œè€Œä¸”ä¸èƒ½æ”¾å…¥å…¶å®ƒä»£ç å—ä¸­ï¼‰ï¼Œè¿™è®© Webpack å¯ä»¥ç®€å•çš„åˆ†æå‡ºå“ªäº› export çš„è¢« import è¿‡äº†ã€‚ å¦‚æœä½ é‡‡ç”¨ ES5 ä¸­çš„æ¨¡å—åŒ–ï¼Œä¾‹å¦‚ module.export={...}ã€require(x+y)ã€if(x){require('./util')}ï¼ŒWebpack æ— æ³•åˆ†æå‡ºå“ªäº›ä»£ç å¯ä»¥å‰”é™¤ã€‚
:::

### åã€æå–å…¬å…±ä»£ç 

webpackå†…ç½®äº†ä¸“é—¨ç”¨äºæå–å¤šä¸ª Chunk ä¸­å…¬å…±éƒ¨åˆ†çš„æ’ä»¶`CommonsChunkPlugin`
```js
const CommonsChunkPlugin = require('webpack/lib/optimize/CommonsChunkPlugin');
new CommonsChunkPlugin({
  // ä»å“ªäº› Chunk ä¸­æå–
  chunks: ['a', 'b'],
  // æå–å‡ºçš„å…¬å…±éƒ¨åˆ†å½¢æˆä¸€ä¸ªæ–°çš„ Chunkï¼Œè¿™ä¸ªæ–° Chunk çš„åç§°
  name: 'common'
})
```
æ¯ä¸ª`CommonsPlugin`éƒ½ä¼šç”Ÿæˆä¸€ä¸ªæ–°çš„ Chunkï¼ŒåŒ…å«æ­¤å…¥å£æ–‡ä»¶å’Œå…¥å£ä¾èµ–çš„æ–‡ä»¶ï¼Œæ•…éœ€è¦åœ¨é¡¹ç›®ä¸­å†™ä¸€ä¸ª base.js æè¿° base Chunk æ‰€ä¾èµ–çš„æ¨¡å—ï¼š
```js
// æ‰€æœ‰é¡µé¢éƒ½ä¾èµ–çš„åŸºç¡€åº“
import 'react';
import 'react-dom';
// æ‰€æœ‰é¡µé¢éƒ½ä½¿ç”¨çš„æ ·å¼
import './base.css';
```
ä¸ºäº†ä» common ä¸­æå–å‡º base ä¹ŸåŒ…å«çš„éƒ¨åˆ†ï¼Œè¿˜éœ€è¦é…ç½®ä¸€ä¸ª CommonsChunkPluginï¼Œç›¸å…³ä»£ç å¦‚ä¸‹ï¼š
```js
const CommonsChunkPlugin = require('webpack/lib/optimize/CommonsChunkPlugin');
new CommonsChunkPlugin({
  // ä» common å’Œ base ä¸¤ä¸ªç°æˆçš„ Chunk ä¸­æå–å…¬å…±çš„éƒ¨åˆ†(ä»å“ªé‡Œå–)
  chunks: ['common', 'base'],
  // æŠŠå…¬å…±çš„éƒ¨åˆ†æ”¾åˆ° base ä¸­,(æ–°chunkçš„åç§°æ˜¯base)
  name: 'base'
})
```
ä»¥ä¸Šï¼Œé‡æ–°æ„å»ºåå°†å¾—åˆ°ï¼š
- base.jsï¼šæ‰€æœ‰ç½‘é¡µéƒ½ä¾èµ–çš„åŸºç¡€åº“ç»„æˆçš„ä»£ç ï¼›
- common.jsï¼šç½‘é¡µAã€Béƒ½éœ€è¦çš„ï¼Œä½†åˆä¸åœ¨ base.js æ–‡ä»¶ä¸­å‡ºç°è¿‡çš„ä»£ç ï¼›
- a.jsï¼šç½‘é¡µ A å•ç‹¬éœ€è¦çš„ä»£ç ï¼›
- b.jsï¼šç½‘é¡µ B å•ç‹¬éœ€è¦çš„ä»£ç ï¼›

ä¸ºäº†è®©ç½‘é¡µæ­£å¸¸è¿è¡Œï¼Œä»¥ç½‘é¡µ A ä¸ºä¾‹ï¼Œä½ éœ€è¦åœ¨å…¶ HTML ä¸­æŒ‰ç…§ä»¥ä¸‹é¡ºåºå¼•å…¥ä»¥ä¸‹æ–‡ä»¶æ‰èƒ½è®©ç½‘é¡µæ­£å¸¸è¿è¡Œï¼š
```html
<script src="base.js"></script>
<script src="common.js"></script>
<script src="a.js"></script>
```

### åä¸€ã€åˆ†å‰²ä»£ç æŒ‰éœ€åŠ è½½ã€ğŸŸ¡webpack3.0å¼•å…¥ã€‘

webpackå†…ç½®äº†å¼ºå¤§çš„åˆ†å‰²ä»£ç çš„åŠŸèƒ½å®ç°æŒ‰éœ€åŠ è½½ï¼š

/* webpackChunkName: "show" / çš„å«ä¹‰æ˜¯ä¸º**åŠ¨æ€ç”Ÿæˆçš„ Chunk èµ‹äºˆä¸€ä¸ªåç§°ï¼Œä»¥æ–¹ä¾¿æˆ‘ä»¬è¿½è¸ªå’Œè°ƒè¯•ä»£ç ã€‚** å¦‚æœä¸æŒ‡å®šåŠ¨æ€ç”Ÿæˆçš„ Chunk çš„åç§°ï¼Œé»˜è®¤åç§°å°†ä¼šæ˜¯ [id].jsã€‚

```js
window.document.getElementById('btn').addEventListener('click', function () {
  // å½“æŒ‰é’®è¢«ç‚¹å‡»åæ‰å»åŠ è½½ show.js æ–‡ä»¶ï¼Œæ–‡ä»¶åŠ è½½æˆåŠŸåæ‰§è¡Œæ–‡ä»¶å¯¼å‡ºçš„å‡½æ•°
  import(/* webpackChunkName: "show" */ './show').then((show) => {
    show('Webpack');
  })
});
```
`import(/* webpackChunkName: "show" */ './show')`ï¼Œwebpackå†…ç½®äº†å¯¹`import(*)`è¯­å¥çš„æ”¯æŒï¼š

  - ä»¥`./show.js`ä¸ºå…¥å£ç”Ÿæˆä¸€ä¸ªæ–°çš„Chunk
  - å½“ä»£ç æ‰§è¡Œåˆ° import æ‰€åœ¨è¯­å¥æ‰ä¼šåŠ è½½ç”±Chunkå¯¹åº”ç”Ÿæˆçš„æ–‡ä»¶
  - import è¿”å› Promiseï¼Œæ–‡ä»¶åŠ è½½æˆåŠŸæ—¶åœ¨.thenæ–¹æ³•ä¸­è·å–åˆ°show.jså¯¼å‡ºå†…å®¹

```js
//ä¸ºäº†æ­£ç¡®çš„è¾“å‡ºåœ¨ /* webpackChunkName: "show" */ ä¸­é…ç½®çš„ ChunkNameï¼Œè¿˜éœ€è¦é…ç½®ä¸‹ Webpack
module.exports = {
  // JS æ‰§è¡Œå…¥å£æ–‡ä»¶
  entry: {
    main: './main.js',
  },
  output: {
    // ä¸ºä» entry ä¸­é…ç½®ç”Ÿæˆçš„ Chunk é…ç½®è¾“å‡ºæ–‡ä»¶çš„åç§°
    filename: '[name].js',
    // ä¸ºåŠ¨æ€åŠ è½½çš„ Chunk é…ç½®è¾“å‡ºæ–‡ä»¶çš„åç§°
    chunkFilename: '[name].js',
  }
};
```

### åäºŒã€å¼€å¯ Scope Hoistingã€ğŸŸ¡webpack3.0å¼•å…¥ã€‘

- æ˜¯ä»€ä¹ˆï¼šä½œç”¨åŸŸæå‡ï¼Œè®©webpackæ‰“åŒ…å‡ºçš„ä»£ç æ–‡ä»¶æ›´å°ã€è¿è¡Œæ›´å¿«ã€‚

- åŸç†ï¼šåˆ†ææ¨¡å—é—´çš„ä¾èµ–å…³ç³»ï¼Œå°½å¯èƒ½çš„æŠŠæ‰“æ•£çš„æ¨¡å—åˆå¹¶åˆ°ä¸€ä¸ªå‡½æ•°ä¸­å»ï¼Œå‰æä¸èƒ½é€ æˆä»£ç å†—ä½™ã€‚æºç å¿…é¡»ä½¿ç”¨ES6æ¨¡å—åŒ–è¯­å¥ï¼ŒåŸå› å’Œ`Tree Shaking`ç±»ä¼¼ã€‚

- ä½¿ç”¨ï¼šWebpack å†…ç½®çš„åŠŸèƒ½ï¼Œåªéœ€è¦é…ç½®ä¸€ä¸ªæ’ä»¶`ModuleConcatenationPlugin`
  ```js
  const ModuleConcatenationPlugin = require('webpack/lib/optimize/ModuleConcatenationPlugin');
  module.exports = {
    plugins: [
      // å¼€å¯ Scope Hoisting
      new ModuleConcatenationPlugin(),
    ],
  };
  ```
  åŒæ—¶ï¼Œè€ƒè™‘åˆ° Scope Hoisting ä¾èµ–æºç éœ€é‡‡ç”¨ ES6 æ¨¡å—åŒ–è¯­æ³•ï¼Œè¿˜éœ€è¦é…ç½® mainFields
  ```js
  module.exports = {
    resolve: {
      // é’ˆå¯¹ Npm ä¸­çš„ç¬¬ä¸‰æ–¹æ¨¡å—ä¼˜å…ˆé‡‡ç”¨ jsnext:main ä¸­æŒ‡å‘çš„ ES6 æ¨¡å—åŒ–è¯­æ³•çš„æ–‡ä»¶
      mainFields: ['jsnext:main', 'browser', 'main']
    },
  };
  ```

### åä¸‰ã€è¾“å‡ºåˆ†æ ğŸš©   

éœ€è¦å¯¹è¾“å‡ºç»“æœåˆ†æï¼Œä»¥å†³å®šä¸‹ä¸€æ­¥çš„ä¼˜åŒ–æ–¹å‘ã€‚

ç›´æ¥çš„æ–¹å¼,é˜…è¯»webpackè¾“å‡ºçš„ä»£ç ï¼Œä½†å¯é˜…è¯»æ€§å¤ªå·®ï¼Œéœ€å€ŸåŠ©å¯è§†åŒ–åˆ†æå·¥å…·ã€‚

- **webpack --profile --json > stats.json**

  ```json
  "scripts": {
    "build": "webpack",
    "generateAnalyzFile": "webpack --profile --json > stats.json"
  },
  ```
  1. --profileï¼šè®°å½•ä¸‹æ„å»ºè¿‡ç¨‹ä¸­çš„è€—æ—¶ä¿¡æ¯ï¼›
  2. --jsonï¼šä»¥ JSON çš„æ ¼å¼è¾“å‡ºæ„å»ºç»“æœï¼Œæœ€ååªè¾“å‡ºä¸€ä¸ª .json æ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶ä¸­åŒ…æ‹¬æ‰€æœ‰æ„å»ºç›¸å…³çš„ä¿¡æ¯ï¼›
  3. `stats.json` æ˜¯ UNIX/Linux ç³»ç»Ÿä¸­çš„ç®¡é“å‘½ä»¤ã€å«ä¹‰æ˜¯æŠŠ webpack --profile --json è¾“å‡ºçš„å†…å®¹é€šè¿‡ç®¡é“è¾“å‡ºåˆ° stats.json æ–‡ä»¶ä¸­ã€‚

  åœ¨å¯åŠ¨ Webpack æ—¶å¸¦ä¸Šä»¥ä¸Šä¸¤ä¸ªå‚æ•°ï¼Œå¯åŠ¨å‘½ä»¤å¦‚ä¸‹ `webpack --profile --json > stats.json`ï¼Œä½ ä¼šå‘ç°é¡¹ç›®ä¸­å¤šå‡ºäº†ä¸€ä¸ª stats.json æ–‡ä»¶ã€‚ è¿™ä¸ª stats.json æ–‡ä»¶æ˜¯ç»™å¯è§†åŒ–åˆ†æå·¥å…·ä½¿ç”¨çš„ã€‚

- **å®˜æ–¹å¯è§†åŒ–å·¥å…·[Webpack Analyse](https://webpack.github.io/analyse/)**

  ä¸Šä¼ `stats.json`çš„ç½‘ç«™ï¼Œæœ¬åœ°è§£æï¼Œä¿è¯æ•°æ®å®‰å…¨ã€‚ä»Modulesã€Chunksã€Assetsã€Warningsã€Errorsã€Hintsåˆ†æã€‚

- **[webpack-bundle-analyzer](https://www.npmjs.com/package/webpack-bundle-analyzer)**

  ç›¸æ¯”`webpack Analyse`æ›´ç›´è§‚æ¸…æ™°ï¼Œä¸”ä¸å®¹æ˜“æŠ¥é”™ã€‚
  
  ```js
  //pnpm i webpack-bundle-analyzer
  const { BundleAnalyzerPlugin } = require("webpack-bundle-analyzer");
   plugins: [
    new BundleAnalyzerPlugin()
  ],
  - æ‰“åŒ…å‡ºçš„æ–‡ä»¶ä¸­éƒ½åŒ…å«äº†ä»€ä¹ˆï¼›
  - æ¯ä¸ªæ–‡ä»¶çš„å°ºå¯¸åœ¨æ€»ä½“ä¸­çš„å æ¯”ï¼Œä¸€çœ¼çœ‹å‡ºå“ªäº›æ–‡ä»¶å°ºå¯¸å¤§ï¼›
  - æ¨¡å—ä¹‹é—´çš„åŒ…å«å…³ç³»ï¼›
  - æ¯ä¸ªæ–‡ä»¶çš„ Gzip åçš„å¤§å°ã€‚
  ```
 