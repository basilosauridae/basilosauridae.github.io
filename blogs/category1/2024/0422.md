---
title: æ¨¡å—åŒ–å¼€å‘ & webpack
date: 2024/04/22
tags:
  - å·¥ç¨‹åŒ–
categories:
  - æ€»ç»“
---
## å‰ç½®æ¼”ç»ƒ

### 1.åˆå§‹åŒ–

å…ˆå‡†å¤‡ä¸€ä¸ªfileï¼Œ`npm init -y`åˆå§‹åŒ–ï¼Œ`package.json`ä¸­æ·»åŠ :
```json
"devDependencies": {
  "webpack":"5.91.0",
  "webpack-cli": "5.1.4"
}
```
### 2.æ·»åŠ entryï¼Œæ€è€ƒé—®é¢˜ï¼šä¸ºä»€ä¹ˆè¦æ‰“åŒ…æ„å»º

### 3.æ·»åŠ output

- `webpack.config.js`æ·»åŠ outputï¼Œå¹¶è¿è¡Œ`npm install`
```json
output:{
  filename:"bundle.js",
  path:__dirname + "/dist"
}
```
- åœ¨ package.json ä¸­æ·»åŠ  `"build":"webpack"`ï¼Œè¿è¡Œ`npm run build`ï¼Œé¡¹ç›®ä¸‹ç”Ÿæˆäº†`dist/bundle.js`å°±æ˜¯å‡ºå£æ–‡ä»¶ã€‚
```json
"scripts": {
  "build":"webpack"
},
```

### 4.æ·»åŠ module
- moduleä¸­æ˜¯å…³äº**JSã€CSSã€å›¾ç‰‡ã€å­—ä½“æ–‡ä»¶**éƒ½éœ€è¦åŠ å·¥çš„æ¨¡å—çš„ä¸åŒè§„åˆ™

1ï¸âƒ£ ã€**JS**ã€‘moduleä¸­çš„[babel-loader](https://www.babeljs.cn/docs/)ï¼Œæœ‰ä¸¤ç§é…ç½®æ–¹å¼ï¼šğŸš—

ğŸš— é…ç½®æ–¹å¼ä¸€ï¼š
```js
 module:{
  rules:[{//é’ˆå¯¹äºjsçš„å¤„ç†
    test:/\.js/,
    use:{
      loader:"babel-loader",//å°†babelå’Œwebpackè¿›è¡Œæ¡¥æ¥çš„åŠ è½½å™¨
      options:{presets:["@babel/preset-env","@babel/preset-typescript"]}}}]}
```
ğŸš— é…ç½®æ–¹å¼äºŒï¼šé¡¹ç›®æ ¹ç›®å½•ä¸‹é…ç½®.babelrcï¼šä»¥ä¸‹è¿™äº›presetsä¹Ÿéœ€å®‰è£…å¯¹åº”åŸºæœ¬ä¾èµ–
:::: code-group
::: code-group-item .babelrcæ–‡ä»¶

```js
{ // babel presetsæ˜¯å¹²å˜›çš„ï¼Ÿå®˜ç½‘ => https://www.babeljs.cn/docs/presets
  // babel presetsæ˜¯ä¸€ç³»åˆ—æ’ä»¶çš„é›†åˆé¢„è®¾ğŸ§­ï¼Œè¿™äº›æ’ä»¶ç”¨æ¥è½¬æ¢ ES6/ES7/ES8 åˆ° ES5
  "presets": [
    "@babel/preset-env",//è½¬æ¢pluginsçš„å°è£…
    "@babel/preset-typescript"//è½¬æ¢tsçš„å¤„ç†
]}
```

:::
::: code-group-item package.json

```json
"devDependencies": {
    ...
    "babel-loader": "9.1.3",
    "@babel/core": "7.24.3",
    "@babel/preset-env": "7.24.3",
    "@babel/preset-typescript": "7.24.1"
  }
```
:::
::::

2ï¸âƒ£ ã€**CSS**ã€‘moduleä¸­ css-loader å’Œ [mini-css-extract-plugin](https://webpack.js.org/plugins/mini-css-extract-plugin/)çš„ç»“åˆä½¿ç”¨,æ‰“åŒ…äº§ç‰©è®©csså’Œjsåˆ†ç¦»ã€‚

ä½¿ç”¨åœºæ™¯ï¼šéœ€è¦å•ç‹¬æå–cssæ ·å¼ï¼Œå¼€å‘çš„æ˜¯é€šç”¨æ¨¡å—ï¼Œå®ç°cssé«˜åº¦å¤ç”¨ã€‚

:::: code-group
::: code-group-item webpack.config.js

```js
const MiniCssExtractPlugin = require("mini-css-extract-plugin");
module.exports = {
  plugins: [new MiniCssExtractPlugin()],
  module: {
    rules: [{ 
      test: /\.css$/i,
      use: [MiniCssExtractPlugin.loader, "css-loader"]}
]}}
```
:::
::: code-group-item package.json

```json
"devDependencies": {
    ...
    "css-loader": "6.10.0",
    "style-loader": "3.3.4",
    "mini-css-extract-plugin": "2.8.1",
  }
```
:::
::::

### 5.mode:`webpack5`å¿…é¡»æŒ‡å®šmode,å¦åˆ™æ‰“åŒ…ä¼šæŠ¥é”™

![](https://cetacea-1304984885.cos.ap-shanghai.myqcloud.com/pieces/Snipaste_2024-04-22_19-44-39.jpg)

### 6.optimizationçš„splitChunksä¼˜åŒ–

[OptimizationWebpack](https://webpack.js.org/configuration/optimization/)æ ¹æ®é€‰æ‹©çš„æ¨¡å¼ä¸ºæ‚¨è¿è¡Œä¼˜åŒ–ï¼Œä½†æ‰€æœ‰ä¼˜åŒ–éƒ½å¯ç”¨äºæ‰‹åŠ¨é…ç½®å’Œè¦†ç›–ã€‚splitChunksæ˜¯å…¶ä¸­ä¹‹ä¸€ã€‚

```js
output:{
  filename: "[name].[contenthash].js"
},
 optimization: {
    splitChunks: {
      minChunks: 2,
      maxSize: 20 * 1024,
      cacheGroups: {
        commons: {
          test: /[\\/]node_modules[\\/]/,
          // cacheGroupKey here is `commons` as the key of the cacheGroup
          name(module, chunks, cacheGroupKey) {
            console.log("ğŸš€ ~ name ~ chunks:", chunks);
            const moduleFileName = module
              .identifier()
              .split("/")
              .reduceRight((item) => item);
            const allChunksNames = chunks.map((item) => item.name).join("~");
            return `${cacheGroupKey}-${allChunksNames}-${moduleFileName}`;
          },
          chunks: "all",
        },
        defaultVendors: {
          test: /vender/,
          priority: -10,
          reuseExistingChunk: true,
        },
        default: {
          minChunks: 2,
          priority: -20,
          reuseExistingChunk: true,
  }}}}
```


## webpack æ ¸å¿ƒé…ç½®

### 1.Entry

ç”¨äºé…ç½® webpack è¯»å–é¡¹ç›®æ–‡ä»¶çš„å…¥å£ã€‚

### 2.Output

- è‹¥æƒ³æ‰“åŒ…äº§ç‰©ä¸ºå¤šä¸ªjs,å¯åœ¨webpack.config.jsé…ç½®`entry`å’Œ`output`:
```js
output: {
  filename: "[name].[contenthash].js",
},
entry: {
  main: "./src/index.ts",
  vendor: "./src/vendor.ts",
},
```


### 3.Module

### 4.Plugin

### 5.Resolve

ç”¨äºè§£æ

```js
resolve: {
  alias: {
    "@": __dirname + "/src",//ç±»å‹åˆ«åå®šä¹‰ï¼Œå¼•å…¥æ–‡ä»¶å°±å¯ä»¥ä¸ç”¨./äº†
  },
  // å®šä¹‰äº† webpack å¦‚ä½•è‡ªåŠ¨æ·»åŠ åç¼€å
  extensions: [".ts", ".js", ".json"],
},
```

### 6.æ€»ç»“

## webpack åŸç†è§£æ

## webpack è¡¥å……

## webpack ä¼˜åŒ–ï¼ˆinterviewï¼‰